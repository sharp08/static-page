import{d as je,e as Se,g as Re,r as b,W as l,a as re,B as we,b as ae,c as W,i as Ne,I as $e,C as Pe,P as f,f as _e,h as X,k as q,R as te,l as Ae}from"./index-CiXM_f8H.js";import{f as ke,g as De,h as ie,a as Me,u as Le,i as We,C as oe,j as ze,k as Fe,K as M}from"./core.esm-CYy5g6mW.js";import{I as Be,a as Xe}from"./IconClose-Dc-Wj3GC.js";import{I as qe,a as He,b as Ge}from"./IconTickCircle-D_XAf5Vw.js";var B,ne;function Ue(){if(ne)return B;ne=1;var r=je(),n=Se(),e="[object Number]";function t(s){return typeof s=="number"||n(s)&&r(s)==e}return B=t,B}var Ke=Ue();const Ve=Re(Ke);function ce(r,n,e){const t=r.slice();return t.splice(e<0?t.length+e:e,0,t.splice(n,1)[0]),t}function Ye(r,n){return r.reduce((e,t,s)=>{const a=n.get(t);return a&&(e[s]=a),e},Array(r.length))}function L(r){return r!==null&&r>=0}function Je(r,n){if(r===n)return!0;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==n[e])return!1;return!0}function Qe(r){return typeof r=="boolean"?{draggable:r,droppable:r}:r}const le=r=>{let{rects:n,activeIndex:e,overIndex:t,index:s}=r;const a=ce(n,t,e),i=n[s],o=a[s];return!o||!i?null:{x:o.left-i.left,y:o.top-i.top,scaleX:o.width/i.width,scaleY:o.height/i.height}},de="Sortable",ue=l.createContext({activeIndex:-1,containerId:de,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:le,disabled:{draggable:!1,droppable:!1}});function It(r){let{children:n,id:e,items:t,strategy:s=le,disabled:a=!1}=r;const{active:i,dragOverlay:o,droppableRects:u,over:p,measureDroppableContainers:c}=ke(),m=De(de,e),v=o.rect!==null,g=b.useMemo(()=>t.map(E=>typeof E=="object"&&"id"in E?E.id:E),[t]),O=i!=null,C=i?g.indexOf(i.id):-1,x=p?g.indexOf(p.id):-1,D=b.useRef(g),w=!Je(g,D.current),N=x!==-1&&C===-1||w,I=Qe(a);ie(()=>{w&&O&&c(g)},[w,g,O,c]),b.useEffect(()=>{D.current=g},[g]);const $=b.useMemo(()=>({activeIndex:C,containerId:m,disabled:I,disableTransforms:N,items:g,overIndex:x,useDragOverlay:v,sortedRects:Ye(g,u),strategy:s}),[C,m,I.draggable,I.droppable,N,g,x,u,v,s]);return l.createElement(ue.Provider,{value:$},n)}const Ze=r=>{let{id:n,items:e,activeIndex:t,overIndex:s}=r;return ce(e,t,s).indexOf(n)},et=r=>{let{containerId:n,isSorting:e,wasDragging:t,index:s,items:a,newIndex:i,previousItems:o,previousContainerId:u,transition:p}=r;return!p||!t||o!==a&&s===i?!1:e?!0:i!==s&&n===u},tt={duration:200,easing:"ease"},fe="transform",nt=oe.Transition.toString({property:fe,duration:0,easing:"linear"}),st={roleDescription:"sortable"};function rt(r){let{disabled:n,index:e,node:t,rect:s}=r;const[a,i]=b.useState(null),o=b.useRef(e);return ie(()=>{if(!n&&e!==o.current&&t.current){const u=s.current;if(u){const p=Fe(t.current,{ignoreTransform:!0}),c={x:u.left-p.left,y:u.top-p.top,scaleX:u.width/p.width,scaleY:u.height/p.height};(c.x||c.y)&&i(c)}}e!==o.current&&(o.current=e)},[n,e,t,s]),b.useEffect(()=>{a&&i(null)},[a]),a}function yt(r){let{animateLayoutChanges:n=et,attributes:e,disabled:t,data:s,getNewIndex:a=Ze,id:i,strategy:o,resizeObserverConfig:u,transition:p=tt}=r;const{items:c,containerId:m,activeIndex:v,disabled:g,disableTransforms:O,sortedRects:C,overIndex:x,useDragOverlay:D,strategy:w}=b.useContext(ue),N=at(t,g),I=c.indexOf(i),$=b.useMemo(()=>({sortable:{containerId:m,index:I,items:c},...s}),[m,s,I,c]),E=b.useMemo(()=>c.slice(c.indexOf(i)),[c,i]),{rect:U,node:K,isOver:pe,setNodeRef:V}=Me({id:i,data:$,disabled:N.droppable,resizeObserverConfig:{updateMeasurementsFor:E,...u}}),{active:P,activatorEvent:me,activeNodeRect:ge,attributes:he,setNodeRef:Y,listeners:be,isDragging:z,over:ve,setActivatorNodeRef:Ie,transform:ye}=Le({id:i,data:$,attributes:{...st,...e},disabled:N.draggable}),Oe=We(V,Y),j=!!P,J=j&&!O&&L(v)&&L(x),Q=!D&&z,Z=Q&&J?ye:null,Ce=J?Z??(o??w)({rects:C,activeNodeRect:ge,activeIndex:v,overIndex:x,index:I}):null,_=L(v)&&L(x)?a({id:i,items:c,activeIndex:v,overIndex:x}):I,S=P==null?void 0:P.id,h=b.useRef({activeId:S,items:c,newIndex:_,containerId:m}),xe=c!==h.current.items,ee=n({active:P,containerId:m,isDragging:z,isSorting:j,id:i,index:I,items:c,newIndex:h.current.newIndex,previousItems:h.current.items,previousContainerId:h.current.containerId,transition:p,wasDragging:h.current.activeId!=null}),F=rt({disabled:!ee,index:I,node:K,rect:U});return b.useEffect(()=>{j&&h.current.newIndex!==_&&(h.current.newIndex=_),m!==h.current.containerId&&(h.current.containerId=m),c!==h.current.items&&(h.current.items=c)},[j,_,m,c]),b.useEffect(()=>{if(S===h.current.activeId)return;if(S&&!h.current.activeId){h.current.activeId=S;return}const Ee=setTimeout(()=>{h.current.activeId=S},50);return()=>clearTimeout(Ee)},[S]),{active:P,activeIndex:v,attributes:he,data:$,rect:U,index:I,newIndex:_,items:c,isOver:pe,isSorting:j,isDragging:z,listeners:be,node:K,overIndex:x,over:ve,setNodeRef:Oe,setActivatorNodeRef:Ie,setDroppableNodeRef:V,setDraggableNodeRef:Y,transform:F??Ce,transition:Te()};function Te(){if(F||xe&&h.current.newIndex===I)return nt;if(!(Q&&!ze(me)||!p)&&(j||ee))return oe.Transition.toString({...p,property:fe})}}function at(r,n){var e,t;return typeof r=="boolean"?{draggable:r,droppable:!1}:{draggable:(e=r==null?void 0:r.draggable)!=null?e:n.draggable,droppable:(t=r==null?void 0:r.droppable)!=null?t:n.droppable}}M.Down,M.Right,M.Up,M.Left;class H extends re{constructor(n){super(Object.assign(Object.assign({},H.defaultAdapter),n)),this.handleMouseInSideChange=e=>{this._adapter.handleMouseInSideChange(e)},this.getInputWrapperRect=()=>this._adapter.getInputWrapperRect()}hasToast(n){return this._adapter.getState("list").map(t=>{let{id:s}=t;return s}).includes(n)}addToast(n){const e=this._adapter.getState("list");e.push(n),this._adapter.updateToast(e,[],[])}updateToast(n,e){let t=this._adapter.getState("list");t=t.map(a=>a.id===n?Object.assign(Object.assign({},a),e):a);const s=t.filter(a=>a.id===n);this._adapter.updateToast(t,[],s)}removeToast(n){let e=this._adapter.getState("list");const t=[];e=e.filter(s=>s.id===n?(t.push(s),!1):!0),this._adapter.updateToast(e,t,[])}destroyAll(){const n=this._adapter.getState("list");n.length>0&&this._adapter.updateToast([],n,[])}}const se=`${we}-toast`,R={PREFIX:se,WRAPPER:`${se}-wrapper`},k={types:["warning","success","info","error","default"],themes:["normal","light"],directions:["ltr","rtl"]},it={duration:3};class G extends re{constructor(n){super(Object.assign(Object.assign({},G.defaultAdapter),n)),this._timer=null,this._id=null}init(){this.startCloseTimer_(),this._id=this._adapter.getProp("id")}destroy(){this.clearCloseTimer_()}startCloseTimer_(){const n=this._adapter.getProp("duration");n&&Ve(n)&&(this._timer=setTimeout(()=>{this.close()},n*1e3))}close(n){n&&n.stopPropagation(),this._adapter.notifyWrapperToRemove(this._id),this._adapter.notifyClose()}clearCloseTimer_(){this._timer&&(clearTimeout(this._timer),this._timer=null)}restartCloseTimer(){this.clearCloseTimer_(),this.startCloseTimer_()}}const y=R.PREFIX;let T=class extends ae{constructor(n){super(n),this.toastEle=l.createRef(),this.clearCloseTimer=()=>{this.foundation.clearCloseTimer_()},this.startCloseTimer=()=>{this.foundation.startCloseTimer_()},this.restartCloseTimer=()=>{this.foundation.restartCloseTimer()},this.state={},this.foundation=new G(this.adapter)}get adapter(){return Object.assign(Object.assign({},super.adapter),{notifyWrapperToRemove:n=>{this.props.close(n)},notifyClose:()=>{this.props.onClose()}})}componentDidMount(){this.foundation.init()}componentWillUnmount(){this.foundation.destroy()}close(n){this.foundation.close(n)}renderIcon(){const{type:n,icon:e}=this.props,s={warning:l.createElement(Xe,null),success:l.createElement(Ge,null),info:l.createElement(He,null),error:l.createElement(qe,null)}[n],a="large",i=W(`${y}-icon`,`${y}-icon-${n}`);return e?Ne(e)?l.cloneElement(e,{size:a,className:`${y}-icon`}):e:n&&s?l.cloneElement(s,{size:a,className:i}):null}render(){const{content:n,type:e,theme:t,showClose:s,textMaxWidth:a,className:i,style:o}=this.props,u=this.props.direction||this.context.direction,p=W(y,i,{[`${y}-${e}`]:!0,[`${y}-${t}`]:t==="light",[`${y}-rtl`]:u==="rtl"}),c={};c.maxWidth=a;const m="borderless",v="small",g=this.props.positionInList?this.props.positionInList.length-this.props.positionInList.index-1:0,O=l.createElement("div",{ref:this.toastEle,role:"alert","aria-label":`${e||"default"} type`,className:p,style:Object.assign(Object.assign({},o),{transform:`translate3d(0,0,${g*-10}px)`}),onMouseEnter:this.clearCloseTimer,onMouseLeave:this.startCloseTimer,onAnimationStart:this.props.onAnimationStart,onAnimationEnd:this.props.onAnimationEnd},l.createElement("div",{className:`${y}-content`},this.renderIcon(),l.createElement("span",{className:`${y}-content-text`,style:c,"x-semi-prop":"content"},n),s&&l.createElement("div",{className:`${y}-close-button`},l.createElement($e,{onClick:C=>this.close(C),type:"tertiary",icon:l.createElement(Be,{"x-semi-prop":"icon"}),theme:m,size:v}))));if(this.props.stack){const C=this.props.stackExpanded&&this.toastEle.current&&getComputedStyle(this.toastEle.current).height||0;return l.createElement("div",{className:`${y}-zero-height-wrapper`,style:{height:C}},O)}else return O}};T.contextType=Pe;T.propTypes={onClose:f.func,content:f.node,close:f.func,duration:f.number,theme:f.oneOf(k.themes),type:f.oneOf(k.types),textMaxWidth:f.oneOfType([f.string,f.number]),style:f.object,className:f.string,showClose:f.bool,stack:f.bool,stackExpanded:f.bool,icon:f.node,direction:f.oneOf(k.directions)};T.__SemiComponentName__="Toast";T.defaultProps=_e(T.__SemiComponentName__,{onClose:X,content:"",close:X,duration:it.duration,textMaxWidth:450,showClose:!0,stack:!1,stackExpanded:!1,theme:"normal"});var ot=function(r,n){var e={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&n.indexOf(t)<0&&(e[t]=r[t]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,t=Object.getOwnPropertySymbols(r);s<t.length;s++)n.indexOf(t[s])<0&&Object.prototype.propertyIsEnumerable.call(r,t[s])&&(e[t[s]]=r[t[s]]);return e};const ct=(r,n)=>{var{afterClose:e}=r,t=ot(r,["afterClose"]);const[s,a]=b.useState(!0),i=()=>{a(!1)};return l.useImperativeHandle(n,()=>({close:()=>{a(!1)}})),b.useEffect(()=>{s||e(t.id)},[s]),s?l.createElement(T,Object.assign({},t,{close:i})):null},lt=l.forwardRef(ct),A={motion:!0,zIndex:1010,duration:3};function dt(){const[r,n]=l.useState([]);function e(t,s){return n(a=>[{element:t,config:s},...a]),a=>{n(i=>i.filter(o=>{let{config:u}=o;return u.id!==a}))}}return[r,e]}function ut(){const[r,n]=dt(),e=b.useRef(new Map),t=a=>{const i=q("semi_toast_"),o=Object.assign(Object.assign({},a),{id:i});let u;const p=l.createElement(lt,Object.assign({},o,{key:i,afterClose:c=>u(c),ref:c=>{var m;e.current.set(i,{close:(m=c==null?void 0:c.close)!==null&&m!==void 0?m:X})}}));return u=n(p,Object.assign({},o)),i},s=a=>{var i;const{close:o}=(i=e.current.get(a))!==null&&i!==void 0?i:{};o==null||o()};return[{success:a=>t(Object.assign(Object.assign(Object.assign({},A),a),{type:"success"})),info:a=>t(Object.assign(Object.assign(Object.assign({},A),a),{type:"info"})),error:a=>t(Object.assign(Object.assign(Object.assign({},A),a),{type:"error"})),warning:a=>t(Object.assign(Object.assign(Object.assign({},A),a),{type:"warning"})),open:a=>t(Object.assign(Object.assign(Object.assign({},A),a),{type:"default"})),close:a=>s(a)},l.createElement(l.Fragment,null,Array.isArray(r)&&r.length?l.createElement(l.Fragment,null,r.map(a=>a.element)):null)]}const ft=()=>{var r;return r=class d extends ae{constructor(e){super(e),this.stack=!1,this.innerWrapperRef=l.createRef(),this.handleMouseEnter=t=>{this.stack&&this.foundation.handleMouseInSideChange(!0)},this.handleMouseLeave=t=>{var s;this.stack&&(!((s=this.foundation.getInputWrapperRect())===null||s===void 0)&&s.height)&&this.foundation.handleMouseInSideChange(!1)},this.state={list:[],removedItems:[],updatedItems:[],mouseInSide:!1},this.foundation=new H(this.adapter)}get adapter(){return Object.assign(Object.assign({},super.adapter),{updateToast:(e,t,s)=>{this.setState({list:e,removedItems:t,updatedItems:s})},handleMouseInSideChange:e=>{this.setState({mouseInSide:e})},getInputWrapperRect:()=>{var e;return(e=this.innerWrapperRef.current)===null||e===void 0?void 0:e.getBoundingClientRect()}})}static create(e){var t;const s=(t=e.id)!==null&&t!==void 0?t:q("toast");if(d.ref){const a=document.querySelector(`#${this.wrapperId}`);["top","left","bottom","right"].map(i=>{i in e&&(a.style[i]=typeof e[i]=="number"?`${e[i]}px`:e[i])}),!!e.stack!==d.ref.stack&&(d.ref.stack=!!e.stack),d.ref.has(s)?d.ref.update(s,Object.assign(Object.assign({},e),{id:s})):d.ref.add(Object.assign(Object.assign({},e),{id:s}))}else{const a=document.createElement("div");this.wrapperId||(this.wrapperId=q("toast-wrapper").slice(0,26)),a.className=R.WRAPPER,a.id=this.wrapperId,a.style.zIndex=String(typeof e.zIndex=="number"?e.zIndex:d.defaultOpts.zIndex),["top","left","bottom","right"].map(i=>{if(i in d.defaultOpts||i in e){const o=e[i]?e[i]:d.defaultOpts[i];a.style[i]=typeof o=="number"?`${o}px`:o}}),d.defaultOpts.getPopupContainer?d.defaultOpts.getPopupContainer().appendChild(a):document.body.appendChild(a),te.render(l.createElement(d,{ref:i=>d.ref=i}),a,()=>{d.ref.add(Object.assign(Object.assign({},e),{id:s})),d.ref.stack=!!e.stack})}return s}static close(e){d.ref&&d.ref.remove(e)}static destroyAll(){if(d.ref){d.ref.destroyAll();const e=document.querySelector(`#${this.wrapperId}`);te.unmountComponentAtNode(e),e&&e.parentNode.removeChild(e),d.ref=null,this.wrapperId=null}}static getWrapperId(){return this.wrapperId}static info(e){return typeof e=="string"&&(e={content:e}),this.create(Object.assign(Object.assign(Object.assign({},d.defaultOpts),e),{type:"info"}))}static warning(e){return typeof e=="string"&&(e={content:e}),this.create(Object.assign(Object.assign(Object.assign({},d.defaultOpts),e),{type:"warning"}))}static error(e){return typeof e=="string"&&(e={content:e}),this.create(Object.assign(Object.assign(Object.assign({},d.defaultOpts),e),{type:"error"}))}static success(e){return typeof e=="string"&&(e={content:e}),this.create(Object.assign(Object.assign(Object.assign({},d.defaultOpts),e),{type:"success"}))}static config(e){["top","left","bottom","right"].forEach(t=>{t in e&&(d.defaultOpts[t]=e[t])}),typeof e.theme=="string"&&k.themes.includes(e.theme)&&(d.defaultOpts.theme=e.theme),typeof e.zIndex=="number"&&(d.defaultOpts.zIndex=e.zIndex),typeof e.duration=="number"&&(d.defaultOpts.duration=e.duration),typeof e.getPopupContainer=="function"&&(d.defaultOpts.getPopupContainer=e.getPopupContainer)}has(e){return this.foundation.hasToast(e)}add(e){return this.foundation.addToast(e)}update(e,t){return this.foundation.updateToast(e,t)}remove(e){return this.foundation.removeToast(e)}destroyAll(){return this.foundation.destroyAll()}render(){let{list:e}=this.state;const{removedItems:t,updatedItems:s}=this.state;e=Array.from(new Set([...e,...t]));const a=s.map(o=>{let{id:u}=o;return u}),i=o=>{var u;!((u=o==null?void 0:o.foundation)===null||u===void 0)&&u._id&&a.includes(o.foundation._id)&&o.foundation.restartCloseTimer()};return l.createElement(l.Fragment,null,l.createElement("div",{className:W({[`${R.PREFIX}-innerWrapper`]:!0,[`${R.PREFIX}-innerWrapper-hover`]:this.state.mouseInSide}),ref:this.innerWrapperRef,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},e.map((o,u)=>{const p=t.find(c=>c.id===o.id)!==void 0;return l.createElement(Ae,{key:o.id,motion:o.motion,animationState:p?"leave":"enter",startClassName:p?`${R.PREFIX}-animation-hide`:`${R.PREFIX}-animation-show`},c=>{let{animationClassName:m,animationEventsNeedBind:v,isAnimating:g}=c;return p&&!g?null:l.createElement(T,Object.assign({},o,{stack:this.stack,stackExpanded:this.state.mouseInSide,positionInList:{length:e.length,index:u},className:W({[o.className]:!!o.className,[m]:!0})},v,{style:Object.assign({},o.style),close:O=>this.remove(O),ref:i}))})})))}},r.defaultOpts={motion:!0,zIndex:1010,content:""},r.propTypes={content:f.node,duration:f.number,onClose:f.func,icon:f.node,direction:f.oneOf(k.directions),stack:f.bool},r.defaultProps={},r};class pt{static create(n){const e=ft();return e.useToast=ut,n&&e.config(n),e}}const Ct=pt.create();export{It as S,Ct as T,ce as a,le as r,yt as u};
