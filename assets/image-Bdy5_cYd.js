import{m as Se,F as Oe,k as V,r as b,B as M,a as K,b as X,R as u,G as Me,c as E,P as l,H as Pe,D as Ve,E as Le,w as _e,J as Q,K as J,M as de,d as oe,f as $e,N as De,L as Te,O as Ne,Q as Re,S as ke,q as H,U as He,V as Ae,s as ze}from"./index-BEVwWGVc.js";import{I as je}from"./IconClose-DuoACxKe.js";var Be=Oe();const ne=Se(Be);function Fe(c){return b.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},c),b.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23 12c0 .83-.67 1.5-1.5 1.5H6.12l6.44 6.44a1.5 1.5 0 0 1-2.12 2.12l-9-9a1.5 1.5 0 0 1 0-2.12l9-9a1.5 1.5 0 0 1 2.12 2.12L6.12 10.5H21.5c.83 0 1.5.67 1.5 1.5Z",fill:"currentColor"}))}const We=V(Fe,"arrow_left");function Ze(c){return b.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},c),b.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 12c0-.83.67-1.5 1.5-1.5h15.38l-6.44-6.44a1.5 1.5 0 0 1 2.12-2.12l9 9a1.5 1.5 0 0 1 0 2.12l-9 9a1.5 1.5 0 0 1-2.12-2.12l6.44-6.44H2.5A1.5 1.5 0 0 1 1 12Z",fill:"currentColor"}))}const Ue=V(Ze,"arrow_right");function Ke(c){return b.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},c),b.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.28 4.24a1.5 1.5 0 0 1 0 2.12l-5.66 5.66 5.66 5.65a1.5 1.5 0 1 1-2.12 2.13l-6.72-6.72a1.5 1.5 0 0 1 0-2.12l6.72-6.72a1.5 1.5 0 0 1 2.12 0Z",fill:"currentColor"}))}const Xe=V(Ke,"chevron_left");function Ye(c){return b.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},c),b.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17.84 8.06A6.5 6.5 0 1 0 5.18 11 4.5 4.5 0 0 0 5.5 20H17a6 6 0 0 0 .84-11.94Zm-6.16 9.67a.5.5 0 0 0 .64 0l5.15-4.29a.25.25 0 0 0-.16-.44H14V9.5a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5V13H6.7c-.24 0-.35.3-.17.44l5.15 4.3Z",fill:"currentColor"}))}const Ge=V(Ye,"download");function qe(c){return b.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},c),b.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 4C5 4 1 10 1 12s4 8 11 8 11-6 11-8-4-8-11-8Zm5 8a5 5 0 1 1-10 0 5 5 0 0 1 10 0Zm-5 3a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",fill:"currentColor"}))}const Je=V(qe,"eye_opened");function Qe(c){return b.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},c),b.createElement("path",{d:"M2 12c0-.83.67-1.5 1.5-1.5h17a1.5 1.5 0 0 1 0 3h-17A1.5 1.5 0 0 1 2 12Z",fill:"currentColor"}))}const et=V(Qe,"minus");function tt(c){return b.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},c),b.createElement("path",{d:"M20.5 13.5a1.5 1.5 0 0 0 0-3h-7v-7a1.5 1.5 0 0 0-3 0v7h-7a1.5 1.5 0 0 0 0 3h7v7a1.5 1.5 0 0 0 3 0v-7h7Z",fill:"currentColor"}))}const nt=V(tt,"plus");function st(c){return b.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},c),b.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1 6c0-1.1.9-2 2-2h18a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V6Zm20 0H3v12h18V6ZM5 9a1 1 0 0 1 1-1h1.5a1 1 0 0 1 1 1v6a1 1 0 1 1-2 0v-5H6a1 1 0 0 1-1-1Zm11-1a1 1 0 1 0 0 2h.5v5a1 1 0 1 0 2 0V9a1 1 0 0 0-1-1H16Zm-3 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm-1 5a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z",fill:"currentColor"}))}const it=V(st,"real_size_stroked");function at(c){return b.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},c),b.createElement("path",{d:"M14.2 2.2A1 1 0 0 0 12.8.8l-2.5 2.5a1 1 0 0 0 0 1.4l2.5 2.5a1 1 0 1 0 1.4-1.4l-.79-.8H16a5 5 0 0 1 5 5v2a1 1 0 1 0 2 0v-2a7 7 0 0 0-7-7h-2.59l.8-.8Z",fill:"currentColor"}),b.createElement("path",{d:"M3 10c0-1.1.9-2 2-2h12a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V10Z",fill:"currentColor"}))}const ot=V(at,"rotate");function rt(c){return b.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},c),b.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M23 12a11 11 0 1 1-22 0 11 11 0 0 1 22 0Zm-9.5 5.5a1.5 1.5 0 1 0-3 0 1.5 1.5 0 0 0 3 0ZM12 5a1.9 1.9 0 0 0-1.89 2l.3 5.5a1.59 1.59 0 0 0 3.17 0l.3-5.5c.07-1.09-.8-2-1.88-2Z",fill:"currentColor"}))}const lt=V(rt,"upload_error");function ct(c){return b.createElement("svg",Object.assign({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",focusable:!1,"aria-hidden":!0},c),b.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M14 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v6a1 1 0 1 1-2 0V4h-5a1 1 0 0 1-1-1Zm-4 18a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-6a1 1 0 1 1 2 0v5h5a1 1 0 0 1 1 1ZM2 9a1 1 0 0 0 2 0V4h5a1 1 0 1 0 0-2H3a1 1 0 0 0-1 1v6Zm19 5a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1h-6a1 1 0 1 1 0-2h5v-5a1 1 0 0 1 1-1ZM8.5 7.5a1 1 0 0 0-1 1v7a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1v-7a1 1 0 0 0-1-1h-7Zm1 7v-5h5v5h-5Z",fill:"currentColor"}))}const dt=V(ct,"window_adaption_stroked"),ht=`${M}-spin`,ut={PREFIX:ht},gt={SIZE:["small","middle","large"]};class he extends K{static get spinDefaultAdapter(){return{getProp:()=>{},setLoading:a=>{}}}constructor(a){super(Object.assign(Object.assign({},he.spinDefaultAdapter),a))}updateLoadingIfNeedDelay(){const{spinning:a,delay:n}=this._adapter.getProps(),{delay:e}=this._adapter.getStates();if(e){const t=this;this._timer=setTimeout(()=>{t._adapter.setState({loading:a,delay:0})},n)}}destroy(){this._timer&&(clearTimeout(this._timer),this._timer=null)}}var pt=function(c,a){var n={};for(var e in c)Object.prototype.hasOwnProperty.call(c,e)&&a.indexOf(e)<0&&(n[e]=c[e]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(c);t<e.length;t++)a.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(c,e[t])&&(n[e[t]]=c[e[t]]);return n};const Z=ut.PREFIX;class ue extends X{constructor(a){super(a),this.foundation=new he(this.adapter),this.state={delay:a.delay,loading:!0}}static getDerivedStateFromProps(a){return a.delay?a.spinning===!1?{delay:0,loading:!1}:{delay:a.delay}:{loading:a.spinning}}get adapter(){return Object.assign(Object.assign({},super.adapter),{setLoading:a=>{this.setState({loading:a})}})}componentWillUnmount(){this.foundation.destroy()}renderSpin(){const{indicator:a,tip:n}=this.props,{loading:e}=this.state;return e?u.createElement("div",{className:`${Z}-wrapper`},a?u.createElement("div",{className:`${Z}-animate`,"x-semi-prop":"indicator"},a):u.createElement(Me,null),n?u.createElement("div",{"x-semi-prop":"tip"},n):null):null}render(){this.foundation.updateLoadingIfNeedDelay();const a=this.props,{children:n,style:e,wrapperClassName:t,childStyle:s,size:i}=a,o=pt(a,["children","style","wrapperClassName","childStyle","size"]),{loading:r}=this.state,d=E(Z,t,{[`${Z}-${i}`]:i,[`${Z}-block`]:n,[`${Z}-hidden`]:!r});return u.createElement("div",Object.assign({className:d,style:e},this.getDataAttr(o)),this.renderSpin(),u.createElement("div",{className:`${Z}-children`,style:s,"x-semi-prop":"children"},n))}}ue.propTypes={size:l.oneOf(gt.SIZE),spinning:l.bool,children:l.node,indicator:l.node,delay:l.number,tip:l.node,wrapperClassName:l.string,childStyle:l.object,style:l.object};ue.defaultProps={size:"middle",spinning:!0,children:null,indicator:null,delay:0};const ge={PREFIX:`${M}-skeleton`};var ft=function(c,a){var n={};for(var e in c)Object.prototype.hasOwnProperty.call(c,e)&&a.indexOf(e)<0&&(n[e]=c[e]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(c);t<e.length;t++)a.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(c,e[t])&&(n[e[t]]=c[e[t]]);return n};const mt=Pe.SIZE,vt=Pe.SHAPE,se=c=>a=>n=>u.createElement(a,Object.assign({type:c},n));class Y extends b.PureComponent{render(){const a=this.props,{prefixCls:n,className:e,type:t,size:s,shape:i}=a,o=ft(a,["prefixCls","className","type","size","shape"]),r=E(e,`${n}-${t}`,{[`${n}-${t}-${s}`]:t.toUpperCase()==="AVATAR"},{[`${n}-${t}-${i}`]:t.toUpperCase()==="AVATAR"});return u.createElement("div",Object.assign({className:r},o))}}Y.propTypes={type:l.string,prefixCls:l.string,style:l.object,className:l.string,size:l.oneOf(mt),shape:l.oneOf(vt)};Y.defaultProps={prefixCls:ge.PREFIX,size:"medium",shape:"circle"};const bt=se("avatar")(Y),yt=se("image")(Y),wt=se("title")(Y),Ct=se("button")(Y);class pe extends b.PureComponent{render(){const{prefixCls:a,className:n,style:e,rows:t}=this.props,s=E(n,`${a}-paragraph`);return u.createElement("ul",{className:s,style:e},[...Array(t)].map((i,o)=>u.createElement("li",{key:o})))}}pe.propTypes={rows:l.number,prefixCls:l.string,style:l.object,className:l.string};pe.defaultProps={prefixCls:ge.PREFIX,rows:4};var Et=function(c,a){var n={};for(var e in c)Object.prototype.hasOwnProperty.call(c,e)&&a.indexOf(e)<0&&(n[e]=c[e]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(c);t<e.length;t++)a.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(c,e[t])&&(n[e[t]]=c[e[t]]);return n};const we=ge.PREFIX;class z extends b.PureComponent{render(){const a=this.props,{placeholder:n,active:e,children:t,className:s,loading:i,style:o}=a,r=Et(a,["placeholder","active","children","className","loading","style"]),d=E(we,{[`${we}-active`]:!!e},s);let h;return i?h=u.createElement("div",Object.assign({className:d,style:o},r,{"x-semi-prop":"placeholder"}),n):h=t,h}}z.Avatar=bt;z.Title=wt;z.Button=Ct;z.Paragraph=pe;z.Image=yt;z.defaultProps={loading:!0};z.propTypes={active:l.bool,placeholder:l.node,style:l.object,className:l.string,loading:l.bool,children:l.node};var re,Ce;function xt(){if(Ce)return re;Ce=1;var c=Ve(),a=Le(),n="[object Boolean]";function e(t){return t===!0||t===!1||a(t)&&c(t)==n}return re=e,re}var It=xt();const St=Se(It),Pt={PREFIX:`${M}`};var _t=function(c,a){var n={};for(var e in c)Object.prototype.hasOwnProperty.call(c,e)&&a.indexOf(e)<0&&(n[e]=c[e]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(c);t<e.length;t++)a.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(c,e[t])&&(n[e[t]]=c[e[t]]);return n};const U=Pt.PREFIX,Ee=c=>{const{layout:a="horizontal",dashed:n,align:e="center",className:t,margin:s,style:i,children:o}=c,r=_t(c,["layout","dashed","align","className","margin","style","children"]),d=E(`${U}-divider`,t,{[`${U}-divider-horizontal`]:a==="horizontal",[`${U}-divider-vertical`]:a==="vertical",[`${U}-divider-dashed`]:!!n,[`${U}-divider-with-text`]:o&&a==="horizontal",[`${U}-divider-with-text-${e}`]:o&&a==="horizontal"});let h={};return s!==void 0&&(a==="vertical"?h={marginLeft:s,marginRight:s}:a==="horizontal"&&(h={marginTop:s,marginBottom:s})),u.createElement("div",Object.assign({},r,{className:d,style:Object.assign(Object.assign({},h),i)}),o&&a==="horizontal"?typeof o=="string"?u.createElement("span",{className:`${U}-divider_inner-text`,"x-semi-prop":"children"},o):o:null)},P={PREFIX:`${M}-slider`,VERTICAL:`${M}-slider-vertical`,TRACK:`${M}-slider-track`,DOTS:`${M}-slider-dots`,MARKS:`${M}-slider-marks`,HANDLE:`${M}-slider-handle`,HANDLE_DOT:`${M}-slider-handle-dot`},xe=(c,a)=>(!globalThis.Touch||!(c instanceof Touch)||["stopPropagation","preventDefault"].forEach(e=>{let t=a[e];t&&(typeof t=="function"&&(t=function(){return a[e](...arguments)}),c[e]?_e(!0,`"The key ${e}" exist in Touch.`):c[e]=t)}),c);class fe extends K{constructor(a){var n;super(Object.assign(Object.assign({},fe.defaultAdapter),a)),n=this,this.getMinAndMaxPercent=e=>{const{range:t,min:s,max:i}=this._adapter.getProps(),o=t?(e[0]-s)/(i-s):(e-s)/(i-s),r=t?(e[1]-s)/(i-s):1;return{min:this._checkValidity(o),max:this._checkValidity(r)}},this._checkValidity=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return e>s?s:e<t?t:e},this.computeHandleVisibleVal=(e,t,s)=>{const{focusPos:i,currentValue:o}=this._adapter.getStates(),r={min:!1,max:!1};let d;return t?d={min:t(s?this.outPutValue(o[0]):this.outPutValue(o)),max:s?t(this.outPutValue(o[1])):null}:d={min:s?this.outPutValue(o[0]):this.outPutValue(o),max:s?this.outPutValue(o[1]):null},e?(r.min=!0,r.max=!0):typeof e>"u"&&t&&(i==="min"?r.min=!0:i==="max"&&(r.max=!0)),{tipVisible:r,tipChildren:d}},this.valueFormatIsCorrect=e=>Array.isArray(e)?typeof e[0]=="number"&&typeof e[0]=="number":typeof e=="number",this.handleMousePos=(e,t)=>{const s=this._adapter.getParentRect(),i=this._adapter.getScrollParentVal(),o=s?s.left:0,r=s?s.top:0;return{x:e-o+i.scrollLeft,y:t-r+i.scrollTop}},this.getScrollParent=e=>{const t=e,s=/(auto|scroll)/,i=(d,h)=>window.getComputedStyle(d,null).getPropertyValue(h),o=d=>s.test(i(d,"overflow")+i(d,"overflow-y")+i(d,"overflow-x")),r=d=>!d||d===document.body||!(d instanceof Element)?document.body:o(d)?d:r(d.parentNode);return r(t)},this.checkMeetMinMax=e=>{const{vertical:t,verticalReverse:s,range:i}=this._adapter.getProps(),o=this._adapter.getState("currentValue");this.transValueToPos(o);const{sliderX:r,sliderY:d,sliderWidth:h,sliderHeight:g}=this._adapter.getSliderLengths(),{chooseMovePos:m,isDrag:f}=this._adapter.getStates(),y=t?g:h;let v;t&&s?v=d+y:v=t?d:r;let C;return t&&s?C=d:C=t?d+g:r+h,t&&s?e>=v?e=v:e<=C&&(e=C):e<=v?e=v:e>=C&&(e=C),e},this.transPosToValue=(e,t)=>{const s=this.checkMeetMinMax(e),{min:i,max:o,currentValue:r}=this._adapter.getStates(),{range:d,vertical:h,step:g,verticalReverse:m}=this._adapter.getProps(),{sliderX:f,sliderY:y,sliderWidth:v,sliderHeight:C}=this._adapter.getSliderLengths(),I=h?y:f,S=h?C:v;let w;h&&m?w=(I+S-s)/S*(o-i)+i:w=(s-I)/S*(o-i)+i;let _;return d?_=t?r[0]:r[1]:_=r,g!==1&&(w=Math.round(w/g)*g),d&&w!==_?t?[w,r[1]]:[r[0],w]:!d&&w!==_?w:!1},this.transValueToPos=e=>{const{min:t,max:s}=this._adapter.getStates(),{vertical:i,range:o,verticalReverse:r}=this._adapter.getProps(),{sliderX:d,sliderY:h,sliderWidth:g,sliderHeight:m}=this._adapter.getSliderLengths(),f=i?h:d,y=i?m:g;return o?[(e[0]-t)*y/(s-t)+f,(e[1]-t)*y/(s-t)+f]:(e-t)*y/(s-t)+f},this.isMarkActive=e=>{const{min:t,max:s,range:i,included:o}=this._adapter.getProps(),r=this._adapter.getState("currentValue");return typeof(e/1)=="number"&&e>=t&&e<=s?i?(e>r[1]||e<r[0])&&o?"unActive":"active":e<=r&&o?"active":"unActive":!1},this.outPutValue=e=>{const t=o=>{var r,d;return/^\d+(\.\d+)?$/.test(String(o))&&(d=(r=o.toString().split(".")[1])===null||r===void 0?void 0:r.length)!==null&&d!==void 0?d:0},s=this._adapter.getProp("step"),i=(()=>{const o=t(s),r=Math.pow(10,o);return d=>Math.round(d*r)/r})();if(Array.isArray(e)){const o=i(e[0]),r=i(e[1]);return o>r?this.getState("focusPos")==="min"?[r,r]:[o,o]:[o,r]}else return i(e)},this.handleDisabledChange=e=>{this._adapter.updateDisabled(e)},this.checkAndUpdateIsInRenderTreeState=()=>this._adapter.checkAndUpdateIsInRenderTreeState(),this.calculateOutputValue=(e,t)=>{const s=this.transPosToValue(e,t);if(s!==!1)return this.outPutValue(s)},this.handleValueChange=(e,t)=>{const{min:s,max:i}=this._adapter.getStates();let o=null;const r={};this.valueFormatIsCorrect(t)?(Array.isArray(e)&&Array.isArray(t)&&(t=[t[0]<s?s:t[0],t[1]>i?i:t[1]],o=Object.assign(r,{currentValue:t})),typeof e=="number"&&typeof t=="number"&&(t>i?t=i:t=t<s?s:t,o=Object.assign(r,{currentValue:t}))):o=r,o&&this._adapter.transNewPropsToState(o)},this.onHandleDown=(e,t)=>{this._adapter.onHandleDown(e);const s=this._adapter.getState("disabled"),{vertical:i}=this._adapter.getProps(),{dragging:o}=this._adapter.getOverallVars();if(s)return!1;this._adapter.setStateVal("isDrag",!0),this._adapter.setStateVal("chooseMovePos",t),t==="min"?this._adapter.setDragging([!0,o[1]]):this._adapter.setDragging([o[0],!0]);const r=this.handleMousePos(e.clientX,e.clientY);let d=i?r.y:r.x;if(!this._adapter.isEventFromHandle(e))this._dragOffset=0;else{const h=this._getHandleCenterPosition(i,e.target);this._dragOffset=d-h,d=h}return!0},this.onHandleMove=e=>{this._adapter.setEventDefault(e);const{disabled:t,chooseMovePos:s}=this._adapter.getStates(),{vertical:i}=this._adapter.getProps(),{dragging:o}=this._adapter.getOverallVars();if(t)return!1;this.onHandleEnter(s);const r=this.handleMousePos(e.clientX,e.clientY);let d=i?r.y:r.x;if(d=d-this._dragOffset,s==="min"&&o[0]||s==="max"&&o[1]){const h=this.calculateOutputValue(d,s==="min");if(h===void 0)return!1;this._adapter.notifyChange(h),this._adapter.onHandleMove(d,s==="min",void 0,!1,h)}return!0},this.onHandleTouchStart=(e,t)=>{const s=this._adapter.getMinHandleEl(),i=this._adapter.getMaxHandleEl();if(e.target===s||e.target===i){Q(e);const o=xe(e.touches[0],e);this.onHandleDown(o,t)}},this.onHandleTouchMove=e=>{const t=this._adapter.getMinHandleEl(),s=this._adapter.getMaxHandleEl();if(e.target===t||e.target===s){const i=xe(e.touches[0],e);this.onHandleMove(i)}},this.onHandleEnter=e=>{const{disabled:t,focusPos:s}=this._adapter.getStates();t||!s&&e!==s&&this._adapter.onHandleEnter(e)},this.onHandleLeave=()=>{const e=this._adapter.getState("disabled"),t=this._adapter.getState("isDrag");!e&&!t&&this._adapter.onHandleLeave()},this.onHandleUp=e=>{this._adapter.onHandleUpBefore(e);const{disabled:t,chooseMovePos:s}=this._adapter.getStates(),{dragging:i}=this._adapter.getOverallVars();return t?!1:(s==="min"?this._adapter.setDragging([!1,i[1]]):this._adapter.setDragging([i[0],!1]),this._adapter.setStateVal("isDrag",!1),this._adapter.onHandleLeave(),this._adapter.onHandleUpAfter(),!0)},this._handleValueDecreaseWithKeyBoard=(e,t)=>{const{min:s,currentValue:i}=this.getStates(),{range:o}=this.getProps();if(t==="min")if(o){let r=i[0]-e;return r=r<s?s:r,[r,i[1]]}else{let r=i-e;return r=r<s?s:r,r}else{let r=i[1]-e;return r=r<i[0]?i[0]:r,[i[0],r]}},this._handleValueIncreaseWithKeyBoard=(e,t)=>{const{max:s,currentValue:i}=this.getStates(),{range:o}=this.getProps();if(t==="min")if(o){let r=i[0]+e;return r=r>i[1]?i[1]:r,[r,i[1]]}else{let r=i+e;return r=r>s?s:r,r}else{let r=i[1]+e;return r=r>s?s:r,[i[0],r]}},this._handleHomeKey=e=>{const{min:t,currentValue:s}=this.getStates(),{range:i}=this.getProps();return e==="min"?i?[t,s[1]]:t:[s[0],s[0]]},this._handleEndKey=e=>{const{max:t,currentValue:s}=this.getStates(),{range:i}=this.getProps();return e==="min"?i?[s[1],s[1]]:t:[s[0],t]},this.handleKeyDown=(e,t)=>{const{min:s,max:i,currentValue:o}=this.getStates(),{step:r,range:d}=this.getProps();let h;switch(e.key){case"ArrowLeft":case"ArrowDown":h=this._handleValueDecreaseWithKeyBoard(r,t);break;case"ArrowRight":case"ArrowUp":h=this._handleValueIncreaseWithKeyBoard(r,t);break;case"PageUp":h=this._handleValueIncreaseWithKeyBoard(10*r,t);break;case"PageDown":h=this._handleValueDecreaseWithKeyBoard(10*r,t);break;case"Home":h=this._handleHomeKey(t);break;case"End":h=this._handleEndKey(t);break}if(["ArrowLeft","ArrowDown","ArrowRight","ArrowUp","PageUp","PageDown","Home","End"].includes(e.key)){let g=!0;Array.isArray(o)?g=!(o[0]===h[0]&&o[1]===h[1]):g=o!==h,g&&(this._adapter.updateCurrentValue(h),this._adapter.notifyChange(h)),Q(e)}},this._noTooltip=()=>{const{tipFormatter:e,tooltipVisible:t}=this.getProps();return e===null||t===!1},this.onFocus=(e,t)=>{if(this._noTooltip())return;Q(e);const{target:i}=e;try{i.matches(":focus-visible")&&(t==="min"?this._adapter.setStateVal("firstDotFocusVisible",!0):this._adapter.setStateVal("secondDotFocusVisible",!0))}catch{_e(!0,"Warning: [Semi Slider] The current browser does not support the focus-visible")}},this.onBlur=(e,t)=>{if(this._noTooltip())return;const{firstDotFocusVisible:i,secondDotFocusVisible:o}=this.getStates();t==="min"?i&&this._adapter.setStateVal("firstDotFocusVisible",!1):o&&this._adapter.setStateVal("secondDotFocusVisible",!1)},this.handleWrapClick=e=>{const{disabled:t,isDrag:s}=this._adapter.getStates();if(s||t||this._adapter.isEventFromHandle(e))return;const{vertical:i}=this.getProps(),o=this.handleMousePos(e.clientX,e.clientY),r=i?o.y:o.x,d=this.checkWhichHandle(r),h=this.calculateOutputValue(r,d);h!==void 0&&(this._adapter.notifyChange(h),!this._isControlledComponent()&&this.setHandlePos(r,d,!0,h))},this.setHandlePos=function(e,t){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3?arguments[3]:void 0;n._adapter.onHandleMove(e,t,()=>n._adapter.onHandleUpAfter(),s,i)},this.checkWhichHandle=e=>{const{vertical:t,verticalReverse:s}=this.getProps(),{currentValue:i}=this._adapter.getStates(),o=this.transValueToPos(i);let r=!0;return Array.isArray(o)&&(e>o[1]||Math.abs(e-o[0])>Math.abs(e-o[1]))&&(r=!1),t&&s&&(r=!r),r},this.handleWrapperEnter=()=>{this._adapter.setStateVal("showBoundary",!0)},this.handleWrapperLeave=()=>{this._adapter.setStateVal("showBoundary",!1)}}init(){this._checkCurrentValue(),this._dragOffset=0}_checkCurrentValue(){const{currentValue:a,min:n,max:e}=this.getStates();let t;Array.isArray(a)?(t=[],t[0]=this._checkValidity(a[0],n,e),t[1]=this._checkValidity(a[1],n,e)):t=this._checkValidity(a,n,e),this._adapter.updateCurrentValue(t)}destroy(){this._adapter.unSubscribeEventListener()}_getHandleCenterPosition(a,n){const e=n.getBoundingClientRect(),{x:t,y:s}=this.handleMousePos(e.left+e.width*.5,e.top+e.height*.5);return a?s:t}}var Dt=function(c,a){var n={};for(var e in c)Object.prototype.hasOwnProperty.call(c,e)&&a.indexOf(e)<0&&(n[e]=c[e]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(c);t<e.length;t++)a.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(c,e[t])&&(n[e[t]]=c[e[t]]);return n};const T=P.PREFIX;function Tt(c){return c?!!(c.offsetWidth||c.offsetHeight||c.getClientRects().length):!1}class me extends X{constructor(a){super(a),this.renderHandle=()=>{var e,t,s,i,o;const{vertical:r,range:d,tooltipVisible:h,tipFormatter:g,"aria-label":m,"aria-labelledby":f,"aria-valuetext":y,getAriaValueText:v,disabled:C}=this.props,{chooseMovePos:I,isDrag:S,isInRenderTree:w,firstDotFocusVisible:_,secondDotFocusVisible:j}=this.state,L=r?"top":"left",A=this.foundation.getMinAndMaxPercent(this.state.currentValue),N=A.min,B=A.max,{tipVisible:$,tipChildren:G}=this.foundation.computeHandleVisibleVal(h&&w,g,d),q=E(P.HANDLE,{[`${P.HANDLE}-clicked`]:I==="min"&&S}),k=E(P.HANDLE,{[`${P.HANDLE}-clicked`]:I==="max"&&S}),{min:te,max:F,currentValue:D}=this.state,W={"aria-label":m??(C?"Disabled Slider":void 0),"aria-labelledby":f,"aria-disabled":C};r&&Object.assign(W,{"aria-orientation":"vertical"});const x=this.props.handleDot;return d?u.createElement(u.Fragment,null,u.createElement(J,{content:G.min,position:"top",trigger:"custom",rePosKey:N,visible:w&&($.min||_),className:`${P.HANDLE}-tooltip`},u.createElement("span",Object.assign({ref:this.minHanleEl,className:q,style:{[L]:`${N*100}%`,zIndex:I==="min"?2:1},onMouseDown:p=>{this.foundation.onHandleDown(p,"min")},onMouseEnter:()=>{this.foundation.onHandleEnter("min")},onTouchStart:p=>{this.foundation.onHandleTouchStart(p,"min")},onMouseLeave:()=>{this.foundation.onHandleLeave()},onKeyUp:p=>{this.foundation.onHandleUp(p)},onTouchEnd:p=>{this.foundation.onHandleUp(p)},onKeyDown:p=>{this.foundation.handleKeyDown(p,"min")},onFocus:p=>{this.foundation.onFocus(p,"min")},onBlur:p=>{this.foundation.onBlur(p,"min")},role:"slider",tabIndex:C?-1:0},W,{"aria-valuetext":v?v(D[0],0):y,"aria-valuenow":D[0],"aria-valuemax":D[1],"aria-valuemin":te}),(x==null?void 0:x[0])&&u.createElement("div",{className:P.HANDLE_DOT,style:Object.assign(Object.assign({},!((e=x[0])===null||e===void 0)&&e.size?{width:x[0].size,height:x[0].size}:{}),!((t=x[0])===null||t===void 0)&&t.color?{backgroundColor:x[0].color}:{})}))),u.createElement(J,{content:G.max,position:"top",trigger:"custom",rePosKey:B,visible:w&&($.max||j),className:`${P.HANDLE}-tooltip`},u.createElement("span",Object.assign({ref:this.maxHanleEl,className:k,style:{[L]:`${B*100}%`,zIndex:I==="max"?2:1},onMouseDown:p=>{this.foundation.onHandleDown(p,"max")},onMouseEnter:()=>{this.foundation.onHandleEnter("max")},onMouseLeave:()=>{this.foundation.onHandleLeave()},onKeyUp:p=>{this.foundation.onHandleUp(p)},onTouchStart:p=>{this.foundation.onHandleTouchStart(p,"max")},onTouchEnd:p=>{this.foundation.onHandleUp(p)},onKeyDown:p=>{this.foundation.handleKeyDown(p,"max")},onFocus:p=>{this.foundation.onFocus(p,"max")},onBlur:p=>{this.foundation.onBlur(p,"max")},role:"slider",tabIndex:C?-1:0},W,{"aria-valuetext":v?v(D[1],1):y,"aria-valuenow":D[1],"aria-valuemax":F,"aria-valuemin":D[0]}),((s=this.props.handleDot)===null||s===void 0?void 0:s[1])&&u.createElement("div",{className:P.HANDLE_DOT,style:Object.assign(Object.assign({},!((i=this.props.handleDot[1])===null||i===void 0)&&i.size?{width:this.props.handleDot[1].size,height:this.props.handleDot[1].size}:{}),!((o=this.props.handleDot[1])===null||o===void 0)&&o.color?{backgroundColor:this.props.handleDot[1].color}:{})})))):u.createElement(J,{content:G.min,showArrow:this.props.showArrow,position:"top",trigger:"custom",rePosKey:N,visible:w&&($.min||_),className:`${P.HANDLE}-tooltip`},u.createElement("span",Object.assign({onMouseOver:this.foundation.checkAndUpdateIsInRenderTreeState,ref:this.minHanleEl,className:q,style:{[L]:`${N*100}%`,zIndex:I==="min"&&S?2:1},onMouseDown:p=>{this.foundation.onHandleDown(p,"min")},onMouseEnter:()=>{this.foundation.onHandleEnter("min")},onTouchStart:p=>{this.foundation.onHandleTouchStart(p,"min")},onMouseLeave:()=>{this.foundation.onHandleLeave()},onKeyUp:p=>{this.foundation.onHandleUp(p)},onTouchEnd:p=>{this.foundation.onHandleUp(p)},onKeyDown:p=>{this.foundation.handleKeyDown(p,"min")},onFocus:p=>{this.foundation.onFocus(p,"min")},onBlur:p=>{this.foundation.onBlur(p,"min")},role:"slider","aria-valuetext":v?v(D,0):y,tabIndex:C?-1:0},W,{"aria-valuenow":D,"aria-valuemax":F,"aria-valuemin":te}),x&&u.createElement("div",{className:P.HANDLE_DOT,style:Object.assign(Object.assign({},x!=null&&x.size?{width:x.size,height:x.size}:{}),x!=null&&x.color?{backgroundColor:x.color}:{})})))},this.renderTrack=()=>{const{range:e,included:t,vertical:s}=this.props,i=this.foundation.getMinAndMaxPercent(this.state.currentValue),o=i.min,r=i.max;let d=s?{height:e?`${Math.abs(r-o)*100}%`:`${o*100}%`,top:e?`${Math.min(o,r)*100}%`:0}:{width:e?`${Math.abs(r-o)*100}%`:`${o*100}%`,left:e?`${Math.min(o,r)*100}%`:0};return d=t?d:{},u.createElement("div",{className:P.TRACK,style:d,onClick:this.foundation.handleWrapClick})},this.renderStepDot=()=>{const{min:e,max:t,vertical:s,marks:i}=this.props,o=s?"top":"left";return i&&Object.keys(i).length>0?u.createElement("div",{className:P.DOTS},Object.keys(i).map(d=>{const h=this.foundation.isMarkActive(Number(d)),g=E(`${T}-dot`,{[`${T}-dot-active`]:this.foundation.isMarkActive(Number(d))==="active"}),m=(Number(d)-e)/(t-e),f=u.createElement("span",{key:d,onClick:this.foundation.handleWrapClick,className:g,style:{[o]:`calc(${m*100}% - 2px)`}});return h?this.props.tooltipOnMark?u.createElement(J,{content:i[d]},f):f:null})):null},this.renderLabel=()=>{if(!this.props.showMarkLabel)return null;const{min:e,max:t,vertical:s,marks:i,verticalReverse:o}=this.props,r=s?"top":"left";return i&&Object.keys(i).length>0?u.createElement("div",{className:P.MARKS+(s&&o?"-reverse":"")},Object.keys(i).map(h=>{const g=this.foundation.isMarkActive(Number(h)),m=(Number(h)-e)/(t-e);return g?u.createElement("span",{key:h,className:E(`${T}-mark${s&&o?"-reverse":""}`),style:{[r]:`${m*100}%`},onClick:this.foundation.handleWrapClick},i[h]):null})):null},this._getAriaValueText=(e,t)=>{const{getAriaValueText:s}=this.props;return s?s(e,t):e};let{value:n}=this.props;n||(n=this.props.defaultValue),this.state={currentValue:n||(this.props.range?[0,0]:0),min:this.props.min||0,max:this.props.max||0,focusPos:"",onChange:this.props.onChange,disabled:this.props.disabled||!1,chooseMovePos:"",isDrag:!1,clickValue:0,showBoundary:!1,isInRenderTree:!0,firstDotFocusVisible:!1,secondDotFocusVisible:!1},this.sliderEl=u.createRef(),this.minHanleEl=u.createRef(),this.maxHanleEl=u.createRef(),this.dragging=[!1,!1],this.foundation=new fe(this.adapter),this.eventListenerSet=new Set,this.handleDownEventListenerSet=new Set}get adapter(){var a=this;return Object.assign(Object.assign({},super.adapter),{getSliderLengths:()=>{var n;if(this.sliderEl&&this.sliderEl.current){const e=this.sliderEl.current.getBoundingClientRect(),t=(n=this.sliderEl.current.offsetParent)===null||n===void 0?void 0:n.getBoundingClientRect(),s={x:t?e.left-t.left:this.sliderEl.current.offsetLeft,y:t?e.top-t.top:this.sliderEl.current.offsetTop};return{sliderX:s.x,sliderY:s.y,sliderWidth:e.width,sliderHeight:e.height}}return{sliderX:0,sliderY:0,sliderWidth:0,sliderHeight:0}},getParentRect:()=>{const n=this.sliderEl&&this.sliderEl.current&&this.sliderEl.current.offsetParent;if(n)return n.getBoundingClientRect()},getScrollParentVal:()=>{const n=this.foundation.getScrollParent(this.sliderEl.current);return{scrollTop:n.scrollTop,scrollLeft:n.scrollLeft}},isEventFromHandle:n=>{const e=[this.minHanleEl,this.maxHanleEl];let t=!1;return e.forEach(s=>{if(!s)return;const i=s&&s.current,o=$e.findDOMNode(i);o&&o.contains(n.target)&&(t=!0)}),t},getOverallVars:()=>({dragging:this.dragging}),updateDisabled:n=>{this.setState({disabled:n})},transNewPropsToState(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:oe;this.setState(n,e)},notifyChange:n=>{this.props.onChange(Array.isArray(n)?[...n].sort((e,t)=>e-t):n)},setDragging:n=>{this.dragging=n},updateCurrentValue:n=>{const{currentValue:e}=this.state;n!==e&&this.setState({currentValue:n})},setOverallVars:(n,e)=>{this[n]=e},getMinHandleEl:()=>this.minHanleEl.current,getMaxHandleEl:()=>this.maxHanleEl.current,onHandleDown:n=>{this.handleDownEventListenerSet.add(this._addEventListener(document.body,"mousemove",this.foundation.onHandleMove,!1)),this.handleDownEventListenerSet.add(this._addEventListener(window,"mouseup",this.foundation.onHandleUp,!1)),this.handleDownEventListenerSet.add(this._addEventListener(document.body,"touchmove",this.foundation.onHandleTouchMove,!1))},onHandleMove:function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:oe,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4?arguments[4]:void 0;if(!a.foundation.checkAndUpdateIsInRenderTreeState())return;const{value:r}=a.props;let d=i;if(d===void 0){const g=a.foundation.transPosToValue(n,e);if(g===!1)return;d=a.foundation.outPutValue(g)}const{currentValue:h}=a.state;if(!de(a.foundation.outPutValue(h),d)){if(!s&&a.foundation.valueFormatIsCorrect(r))return!1;a.setState({currentValue:d},t)}},setEventDefault:n=>{n.stopPropagation(),n.preventDefault()},setStateVal:(n,e)=>{this.setState({[n]:e})},checkAndUpdateIsInRenderTreeState:()=>{const n=Tt(this.sliderEl.current);return n!==this.state.isInRenderTree&&this.setState({isInRenderTree:n}),n},onHandleEnter:n=>{this.setState({focusPos:n})},onHandleLeave:()=>{this.setState({focusPos:""})},onHandleUpBefore:n=>{var e,t;(t=(e=this.props).onMouseUp)===null||t===void 0||t.call(e,n),n.stopPropagation(),n.preventDefault(),Array.from(this.handleDownEventListenerSet).forEach(s=>s()),this.handleDownEventListenerSet.clear()},onHandleUpAfter:()=>{const{currentValue:n}=this.state,e=this.foundation.outPutValue(n);this.props.onAfterChange(e)},unSubscribeEventListener:()=>{Array.from(this.eventListenerSet).forEach(n=>n())}})}componentDidMount(){this.foundation.init()}componentDidUpdate(a,n){const e=!de(this.props.value,a.value);if(this.props.disabled!==a.disabled&&this.foundation.handleDisabledChange(this.props.disabled),e){const s=this.props.value,i=this.state.currentValue;this.foundation.handleValueChange(i,s),this.props.onAfterChange(this.props.value)}}componentWillUnmount(){this.foundation.destroy()}render(){const{disabled:a,currentValue:n,min:e,max:t}=this.state,s=this.props,{vertical:i,verticalReverse:o,style:r,railStyle:d,range:h,className:g}=s,m=Dt(s,["vertical","verticalReverse","style","railStyle","range","className"]),f=E(`${T}-wrapper`,{[`${T}-disabled`]:a,[`${P.VERTICAL}-wrapper`]:i,[`${T}-reverse`]:i&&o},g),y=E(`${T}-boundary`,{[`${T}-boundary-show`]:this.props.showBoundary&&this.state.showBoundary}),v=E({[`${T}`]:!i,[P.VERTICAL]:i}),C=Array.isArray(n)?[...n].sort():n,I=h?`Range: ${this._getAriaValueText(C[0],0)} to ${this._getAriaValueText(C[1],1)}`:void 0,S=u.createElement("div",Object.assign({className:f,style:r,ref:this.sliderEl,"aria-label":I,onMouseEnter:()=>this.foundation.handleWrapperEnter(),onMouseLeave:()=>this.foundation.handleWrapperLeave()},this.getDataAttr(m)),u.createElement("div",{className:`${T}-rail`,onClick:this.foundation.handleWrapClick,style:d}),this.renderTrack(),this.renderStepDot(),u.createElement("div",null,this.renderHandle()),this.renderLabel(),u.createElement("div",{className:y},u.createElement("span",{className:`${T}-boundary-min`},e),u.createElement("span",{className:`${T}-boundary-max`},t)));return i?S:u.createElement("div",{className:v},S)}_addEventListener(a,n,e){if(a.addEventListener){for(var t=arguments.length,s=new Array(t>3?t-3:0),i=3;i<t;i++)s[i-3]=arguments[i];a.addEventListener(n,e,...s);const o=()=>{a==null||a.removeEventListener(n,e),Promise.resolve().then(()=>{this.eventListenerSet.delete(o)})};return this.eventListenerSet.add(o),o}else return oe}}me.propTypes={defaultValue:l.oneOfType([l.number,l.array]),disabled:l.bool,showMarkLabel:l.bool,included:l.bool,marks:l.object,max:l.number,min:l.number,range:l.bool,step:l.number,tipFormatter:l.func,value:l.oneOfType([l.number,l.array]),vertical:l.bool,onAfterChange:l.func,onChange:l.func,onMouseUp:l.func,tooltipOnMark:l.bool,tooltipVisible:l.bool,showArrow:l.bool,style:l.object,className:l.string,showBoundary:l.bool,railStyle:l.object,verticalReverse:l.bool,getAriaValueText:l.func,handleDot:l.oneOfType([l.shape({size:l.string,color:l.string}),l.arrayOf(l.shape({size:l.string,color:l.string}))])};me.defaultProps={disabled:!1,showMarkLabel:!0,tooltipOnMark:!1,included:!0,max:100,min:0,range:!1,showArrow:!0,step:1,tipFormatter:c=>c,vertical:!1,showBoundary:!1,onAfterChange:c=>{},onChange:c=>{},verticalReverse:!1};const ee={PREFIX:`${M}-image`},Rt={DEFAULT_Z_INDEX:1070},ve=b.createContext({}),le=`${ee.PREFIX}-preview-header`,Ot=b.forwardRef((c,a)=>{let{onClose:n,titleStyle:e,className:t,renderHeader:s,closable:i}=c;return u.createElement(ve.Consumer,null,o=>{let{currentIndex:r,titles:d}=o,h;return d&&typeof r=="number"&&(h=d[r]),u.createElement("section",{ref:a,className:E(le,t)},u.createElement("section",{className:`${le}-title`,style:e},s?s(h):h),i&&u.createElement("section",{className:`${le}-close`,onMouseUp:n},u.createElement(je,null)))})});class Mt extends K{constructor(){super(...arguments),this.changeSliderValue=a=>{const{zoom:n,step:e,min:t,max:s}=this.getProps();let i=a==="plus"?n+e:n-e;i>s?i=s:i<t&&(i=t),this.handleValueChange(i)},this.handleValueChange=a=>{const{onZoomIn:n,onZoomOut:e,zoom:t}=this.getProps();a>t?n(Number((a/100).toFixed(2))):e(Number((a/100).toFixed(2)))},this.handleRatioClick=()=>{const{ratio:a,onAdjustRatio:n}=this.getProps();n(a==="adaptation"?"realSize":"adaptation")},this.handleRotate=a=>{const{onRotate:n}=this.getProps();n&&n(a)}}}const R=`${ee.PREFIX}-preview-footer`;class be extends X{get adapter(){return Object.assign({},super.adapter)}constructor(a){super(a),this.changeSliderValue=n=>{this.foundation.changeSliderValue(n)},this.handleMinusClick=()=>{this.changeSliderValue("minus")},this.handlePlusClick=()=>{this.changeSliderValue("plus")},this.handleRotateLeft=()=>{this.foundation.handleRotate("left")},this.handleRotateRight=()=>{this.foundation.handleRotate("right")},this.handleSlideChange=De(n=>{this.foundation.handleValueChange(n)},50),this.handleRatioClick=()=>{this.foundation.handleRatioClick()},this.customRenderViewMenu=()=>{const{min:n,max:e,step:t,curPage:s,totalNum:i,ratio:o,zoom:r,disabledPrev:d,disabledNext:h,disableDownload:g,onNext:m,onPrev:f,onDownload:y,renderPreviewMenu:v}=this.props,C={min:n,max:e,step:t,curPage:s,totalNum:i,ratio:o,zoom:r,disabledPrev:d,disabledNext:h,disableDownload:g,onNext:m,onPrev:f,onDownload:y,onRotateLeft:this.handleRotateLeft,onRotateRight:this.handleRotateRight,disabledZoomIn:r===e,disabledZoomOut:r===n,onRatioClick:this.handleRatioClick,onZoomIn:this.handlePlusClick,onZoomOut:this.handleMinusClick,menuItems:this.getMenu()};return v(C)},this.getFinalIconElement=(n,e,t)=>{const{showTooltip:s,zIndex:i}=this.props;return s?u.createElement(J,{content:e,key:`tooltip-${t}`,zIndex:i+1},n):n},this.getLocalTextByKey=n=>u.createElement(Te,{componentName:"Image"},e=>e[n]),this.getIconChevronLeft=()=>{const{disabledPrev:n,onPrev:e,prevTip:t}=this.props,s=u.createElement(Xe,{key:"chevron-left",size:"large",className:n?`${R}-disabled`:"",onClick:n?void 0:e}),i=t??this.getLocalTextByKey("prevTip");return this.getFinalIconElement(s,i,"chevron-left")},this.getIconChevronRight=()=>{const{disabledNext:n,onNext:e,nextTip:t}=this.props,s=u.createElement(Ne,{key:"chevron-right",size:"large",className:n?`${R}-disabled`:"",onClick:n?void 0:e}),i=t??this.getLocalTextByKey("nextTip");return this.getFinalIconElement(s,i,"chevron-right")},this.getIconMinus=()=>{const{zoomOutTip:n,zoom:e,min:t}=this.props,s=e===t,i=u.createElement(et,{key:"minus",size:"large",onClick:s?void 0:this.handleMinusClick,className:s?`${R}-disabled`:""}),o=n??this.getLocalTextByKey("zoomOutTip");return this.getFinalIconElement(i,o,"minus")},this.getIconPlus=()=>{const{zoomInTip:n,zoom:e,max:t}=this.props,s=e===t,i=u.createElement(nt,{key:"plus",size:"large",onClick:s?void 0:this.handlePlusClick,className:s?`${R}-disabled`:""}),o=n??this.getLocalTextByKey("zoomInTip");return this.getFinalIconElement(i,o,"plus")},this.getIconRatio=()=>{const{ratio:n,originTip:e,adaptiveTip:t}=this.props,s={key:"ratio",size:"large",className:E(`${R}-gap`),onClick:this.handleRatioClick},i=n==="adaptation"?u.createElement(it,Object.assign({},s)):u.createElement(dt,Object.assign({},s));let o;return n==="adaptation"?o=e??this.getLocalTextByKey("originTip"):o=t??this.getLocalTextByKey("adaptiveTip"),this.getFinalIconElement(i,o,"ratio")},this.getIconRotate=()=>{const{rotateTip:n}=this.props,e=u.createElement(ot,{key:"rotate",size:"large",onClick:this.handleRotateLeft}),t=n??this.getLocalTextByKey("rotateTip");return this.getFinalIconElement(e,t,"rotate")},this.getIconDownload=()=>{const{downloadTip:n,onDownload:e,disableDownload:t}=this.props,s=u.createElement(Ge,{key:"download",size:"large",onClick:t?void 0:e,className:E(`${R}-gap`,{[`${R}-disabled`]:t})}),i=n??this.getLocalTextByKey("downloadTip");return this.getFinalIconElement(s,i,"download")},this.getNumberInfo=()=>{const{curPage:n,totalNum:e}=this.props;return u.createElement("div",{className:`${R}-page`,key:"info"},n,"/",e)},this.getSlider=()=>{const{zoom:n,min:e,max:t,step:s,showTooltip:i}=this.props;return u.createElement(me,{key:"slider",value:n,min:e,max:t,step:s,tipFormatter:o=>`${o}%`,tooltipVisible:i?void 0:!1,onChange:this.handleSlideChange})},this.getMenu=()=>[this.getIconChevronLeft(),this.getNumberInfo(),this.getIconChevronRight(),this.getIconMinus(),this.getSlider(),this.getIconPlus(),this.getIconRatio(),this.getIconRotate(),this.getIconDownload()],this.getFooterMenu=()=>{const n=this.getMenu();return n.splice(3,0,u.createElement(Ee,{layout:"vertical",key:"divider-first"})),n.splice(8,0,u.createElement(Ee,{layout:"vertical",key:"divider-second"})),n},this.foundation=new Mt(this.adapter)}render(){const{className:a,renderPreviewMenu:n,forwardRef:e}=this.props,t=E(R,`${R}-wrapper`,a,{[`${R}-content`]:!n});return u.createElement("section",{className:t,ref:e},n?this.customRenderViewMenu():this.getFooterMenu())}}be.propTypes={curPage:l.number,totalNum:l.number,disabledPrev:l.bool,disabledNext:l.bool,disableDownload:l.bool,className:l.string,zoom:l.number,ratio:l.string,prevTip:l.string,nextTip:l.string,zoomInTip:l.string,zoomOutTip:l.string,rotateTip:l.string,downloadTip:l.string,adaptiveTip:l.string,originTip:l.string,showTooltip:l.bool,onZoomIn:l.func,onZoomOut:l.func,onPrev:l.func,onNext:l.func,onAdjustRatio:l.func,onRotateLeft:l.func,onDownload:l.func};be.defaultProps={min:10,max:500,step:10,showTooltip:!1,disableDownload:!1};class Vt extends K{constructor(a){var n;super(Object.assign({},a)),n=this,this.startMouseClientPosition={x:0,y:0},this.originImageWidth=null,this.originImageHeight=null,this.containerWidth=0,this.containerHeight=0,this._isImageVertical=()=>this.getProp("rotation")%180!==0,this._getContainerBoundingRectSize=()=>{const e=this._adapter.getContainer();e&&(this.containerWidth=e.clientWidth,this.containerHeight=e.clientHeight)},this._getAdaptationZoom=()=>{let e=1;if(this._adapter.getContainer()&&this.originImageWidth&&this.originImageHeight){const{rotation:s}=this.getProps(),{width:i,height:o}=this.calcBoundingRectSize(this.originImageWidth,this.originImageHeight,s),r=this.containerWidth-80,d=this.containerHeight-80;e=Number(Math.min(r/i,d/o).toFixed(2))}return e},this._getInitialZoom=()=>{const{ratio:e}=this.getProps();let t=1;return e==="adaptation"&&(t=this._getAdaptationZoom()),t},this.setLoading=e=>{this._adapter.setLoading(e)},this.handleWindowResize=()=>{this._getContainerBoundingRectSize(),this.initializeImage()},this.handleLoad=e=>{if(e.target){const{naturalWidth:i,naturalHeight:o}=e.target;this.originImageHeight=o,this.originImageWidth=i,this.setState({loading:!1}),this.initializeImage(!1)}const{src:t,onLoad:s}=this.getProps();s&&s(t)},this.handleError=e=>{const{onError:t,src:s}=this.getProps();this.setState({loading:!1}),t&&t(s)},this.handleRatioChange=()=>{this.initializeImage()},this.initializeImageZoom=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const{currZoom:t}=n.getStates(),{onZoom:s}=n.getProps(),i=n._getInitialZoom();t!==i?s(i,e):n.changeZoom(i)},this.initializeTranslate=()=>{this.setState({translate:{x:0,y:0}})},this.initializeImage=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.initializeImageZoom(e),n.initializeTranslate()},this.handleRightClickImage=e=>{const{disableDownload:t}=this.getProps();return t?(e.preventDefault(),e.stopPropagation(),!1):!0},this.getCanDragDirection=(e,t)=>{let s=e>this.containerWidth;return{canDragVertical:t>this.containerHeight,canDragHorizontal:s}},this.changeZoom=(e,t)=>{const s=this._adapter.getImage(),{currZoom:i,translate:o,width:r,height:d}=this.getStates(),{rotation:h}=this.getProps(),g=e/(i||1),m=Math.floor(this.originImageWidth*e),f=Math.floor(this.originImageHeight*e);let y=Math.floor(o.x*g),v=Math.floor(o.y*g);const C=this.calcBoundingRectSize(r,d,h),I={width:C.width*g,height:C.height*g};if(t&&s&&t.target===s){let w=h%360;switch(w<0&&(w=360+w),w){case 0:y=(t.offsetX-.5*r)*(1-e/i)+o.x,v=(t.offsetY-.5*d)*(1-e/i)+o.y;break;case 90:y=(.5*d-t.offsetY)*(1-e/i)+o.x,v=(t.offsetX-.5*r)*(1-e/i)+o.y;break;case 180:y=(.5*r-t.offsetX)*(1-e/i)+o.x,v=(.5*d-t.offsetY)*(1-e/i)+o.y;break;case 270:y=(t.offsetY-.5*d)*(1-e/i)+o.x,v=(.5*r-t.offsetX)*(1-e/i)+o.y;break}}const S=this.getSafeTranslate(I.width,I.height,y,v);if(this.setState({translate:S,width:m,height:f,currZoom:e}),s){const{canDragVertical:w,canDragHorizontal:_}=this.getCanDragDirection(I.width,I.height),j=w||_;this._adapter.setImageCursor(j)}},this.getExtremeTranslate=(e,t)=>({x:(e-this.containerWidth)/2,y:(t-this.containerHeight)/2}),this.getSafeTranslate=(e,t,s,i)=>{const{x:o,y:r}=this.getExtremeTranslate(e,t),{canDragVertical:d,canDragHorizontal:h}=this.getCanDragDirection(e,t);let g=0,m=0;return h&&(g=s>0?Math.min(s,o):Math.max(s,-o)),d&&(m=i>0?Math.min(i,r):Math.max(i,-r)),{x:g,y:m}},this.handleImageMove=e=>{e.buttons===1&&this.moveImage(e)},this.moveImage=e=>{const{clientX:t,clientY:s}=e,{width:i,height:o,translate:r}=this.getStates(),{rotation:d}=this.getProps(),h=this.calcBoundingRectSize(i,o,d),{canDragVertical:g,canDragHorizontal:m}=this.getCanDragDirection(h.width,h.height);if(g||m){let f=m?r.x+t-this.startMouseClientPosition.x:r.x,y=g?r.y+s-this.startMouseClientPosition.y:r.y;const v=this.getSafeTranslate(h.width,h.height,f,y);this.setState({translate:v}),this.startMouseClientPosition={x:t,y:s}}},this.handleImageMouseDown=e=>{this.startMouseClientPosition={x:e.clientX,y:e.clientY}},this.calcBoundingRectMouseOffset=e=>{const{width:t,height:s,offset:i,rotation:o=0}=e;let r=o%360;r=r>=0?r:360+r;let d=0,h=0;switch(r){case 0:d=i.x,h=i.y;break;case 90:d=s-i.y,h=i.x;break;case 180:d=t-i.x,h=s-i.y;break;case 270:d=i.y,h=t-i.x;break}return{x:d,y:h}}}init(){this._getContainerBoundingRectSize()}calcBoundingRectSize(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const t=(arguments.length>2&&arguments[2]!==void 0?arguments[2]:0)*Math.PI/180,s=Math.abs(Math.sin(t)),i=Math.abs(Math.cos(t)),o=a*i+n*s,r=a*s+n*i;return{width:o,height:r}}}const Lt=ee.PREFIX,ce=`${Lt}-preview-image`;class ye extends X{get adapter(){return Object.assign(Object.assign({},super.adapter),{getContainer:()=>this.containerRef.current,getImage:()=>this.imageRef.current,setLoading:a=>{this.setState({loading:a})},setImageCursor:a=>{this.imageRef.current.style.cursor=a?"grab":"default"}})}constructor(a){super(a),this.onWindowResize=()=>{this.foundation.handleWindowResize()},this.handleRightClickImage=n=>{this.foundation.handleRightClickImage(n)},this.handleLoad=n=>{this.foundation.handleLoad(n)},this.handleError=n=>{this.foundation.handleError(n)},this.handleImageMove=n=>{this.foundation.handleImageMove(n)},this.handleMouseDown=n=>{this.foundation.handleImageMouseDown(n)},this.state={width:0,height:0,loading:!0,translate:{x:0,y:0},currZoom:this.props.zoom},this.containerRef=u.createRef(),this.imageRef=u.createRef(),this.foundation=new Vt(this.adapter)}componentDidMount(){this.foundation.init(),window.addEventListener("resize",this.onWindowResize)}componentWillUnmount(){window.removeEventListener("resize",this.onWindowResize)}componentDidUpdate(a,n){const e="zoom"in this.props&&this.props.zoom!==this.state.currZoom,t=this.props.src&&this.props.src!==a.src;t&&this.foundation.setLoading(!0),!e&&!t&&a&&("ratio"in this.props&&this.props.ratio!==a.ratio&&this.foundation.handleRatioChange(),"rotation"in this.props&&this.props.rotation!==a.rotation&&this.onWindowResize())}render(){const{src:a,rotation:n,crossOrigin:e}=this.props,{loading:t,width:s,height:i,translate:o}=this.state,r={position:"absolute",visibility:t?"hidden":"visible",transform:`translate(${o.x}px, ${o.y}px) rotate(${n}deg)`,width:s,height:i};return u.createElement("div",{className:`${ce}`,ref:this.containerRef},u.createElement("img",{ref:this.imageRef,src:a,alt:"previewImag",className:`${ce}-img`,key:a,onMouseMove:this.handleImageMove,onMouseDown:this.handleMouseDown,onContextMenu:this.handleRightClickImage,onDragStart:d=>d.preventDefault(),onLoad:this.handleLoad,onError:this.handleError,style:r,crossOrigin:e}),t&&u.createElement(ue,{size:"large",wrapperClassName:`${ce}-spin`}))}}ye.propTypes={src:l.string,rotation:l.number,style:l.object,zoom:l.number,ratio:l.string,disableDownload:l.bool,clickZoom:l.number,setRatio:l.func,onZoom:l.func,onLoad:l.func,onError:l.func};ye.defaultProps={zoom:void 0};var $t=function(c,a,n,e){function t(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function o(h){try{d(e.next(h))}catch(g){i(g)}}function r(h){try{d(e.throw(h))}catch(g){i(g)}}function d(h){h.done?s(h.value):t(h.value).then(o,r)}d((e=e.apply(c,a||[])).next())})};const Nt=(c,a)=>{const n=c==null?void 0:c.composedPath();return n==null?void 0:n.slice(0,n.length-4).some(t=>t.className&&typeof t.className=="string"?a.some(s=>t.className.includes(s)):!1)},kt=(c,a,n)=>$t(void 0,void 0,void 0,function*(){try{const e=yield fetch(c);if(e.ok){const t=yield e.blob(),s=URL.createObjectURL(t),i=document.createElement("a");i.href=s,i.download=a,i.click(),URL.revokeObjectURL(s),i.remove()}else n(c)}catch{n(c)}}),Ht=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[];const e=c.length,t=a.length,s=e<=t?e:t;return new Array(s).fill(0).forEach((i,o)=>{n.push(a[o]),n.push(c[o])}),e>t?n=n.concat(c.slice(t,e)):e<t&&(n=n.concat(a.slice(e,t))),n},At=(c,a,n,e)=>{const t=a-n,s=a+n,i=c.length;let o=[],r=[];n>=Math.floor(i/2)?e?(o=c.concat(c).slice(t+i<0?0:t+i,a+i),r=c.concat(c).slice(a+1,s+1<2*i?s+1:2*i)):(o=c.slice(0,a),r=c.slice(a+1,i)):e?(o=c.concat(c).slice(t+i,a+i),r=c.concat(c).slice(a+1,s+1)):t>=0&&s<i?(o=c.slice(t,a),r=c.slice(a+1,s+1)):t<0?(o=c.slice(0,a),r=c.slice(a+1,2*n+1)):(r=c.slice(a+1,i),o=c.slice(i-2*n-1,a));const d=Ht(o.reverse(),r);return Array.from(new Set(d))},zt=["icon","footer"];class jt extends K{constructor(a){var n;super(Object.assign({},a)),n=this,this._timer=null,this._startMouseDown={x:0,y:0},this.handleViewVisibleChange=()=>{const{viewerVisible:e}=this.getStates();e&&(this.setState({viewerVisible:!1}),this.clearTimer())},this.handleMouseMove=e=>{this._persistEvent(e),this.mouseMoveHandler(e)},this.mouseMoveHandler=De(e=>{const{viewerVisible:t}=this.getStates();this._adapter.isValidTarget(e)?(t||this.setState({viewerVisible:!0}),this.updateTimer()):this.clearTimer()},50),this.updateTimer=()=>{const{viewerVisibleDelay:e}=this.getProps();this.clearTimer(),this._timer=setTimeout(this.handleViewVisibleChange,e)},this.clearTimer=()=>{this._timer&&(clearTimeout(this._timer),this._timer=null)},this.handleWheel=e=>{this.onWheel(e),Q(e)},this.onWheel=e=>{const{zoomStep:t,maxZoom:s,minZoom:i}=this.getProps(),{zoom:o}=this.getStates();let r;e.deltaY<0?o+t<=s&&(r=Number((o+t).toFixed(2))):e.deltaY>0&&o-t>=i&&(r=Number((o-t).toFixed(2))),Re(r)||this.handleZoomImage(r,!0,e)},this.handleMouseUp=e=>{const{maskClosable:t}=this.getProps();let s=!Nt(e,zt);const{clientX:i,clientY:o}=e,{x:r,y:d}=this._startMouseDown;(Math.abs(i-r)>5||Math.abs(d-o)>5)&&(s=!1),s&&t&&this._adapter.notifyVisibleChange(!1)},this.handleMouseDown=e=>{const{clientX:t,clientY:s}=e;this._startMouseDown={x:t,y:s}},this.handleKeyDown=e=>{const{closeOnEsc:t}=this.getProps();if(t&&e.keyCode===ke.ESC){e.stopPropagation(),this._adapter.notifyVisibleChange(!1),this._adapter.notifyClose();return}},this.handleSwitchImage=e=>{const t=e==="prev"?-1:1,{imgSrc:s,currentIndex:i}=this.getStates(),o=s.length,r=(i+t+o)%o;"currentIndex"in this.getProps()?this._adapter.getIsInGroup()&&this._adapter.getContext("setCurrentIndex")(r):this.setState({currentIndex:r}),this._adapter.notifyChange(r,e),this.setState({direction:e,rotation:0})},this.handleDownload=()=>{const{currentIndex:e,imgSrc:t}=this.getStates(),s=this._adapter.getSetDownloadFunc(),i=t[e],o=s?s(i):i.slice(i.lastIndexOf("/")+1).split("?")[0];kt(i,o,this._adapter.notifyDownloadError),this._adapter.notifyDownload(i,e)},this.handlePreviewClose=e=>{this._adapter.notifyVisibleChange(!1),this._adapter.notifyClose(),Q(e)},this.handleAdjustRatio=e=>{this.setState({ratio:e}),this._adapter.notifyRatioChange(e)},this.handleRotateImage=e=>{const{rotation:t}=this.getStates(),i=t+(e==="left"?-90:90);this.setState({rotation:i}),this._adapter.notifyRotateChange(i)},this.handleZoomImage=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,s=arguments.length>2?arguments[2]:void 0;const{zoom:i}=n.getStates();i!==e&&(t&&n._adapter.notifyZoom(e,e>i),n._adapter.changeImageZoom(e,s),n.setState({zoom:e}))},this.preloadGapImage=()=>{const{preLoad:e,preLoadGap:t,infinite:s,currentIndex:i}=this.getProps(),{imgSrc:o}=this.getStates();if(!e||typeof t!="number"||t<1)return;const r=At(o,i,t,s);if(r.length===0)return;const d=new Image;let h=0;function g(m){h++,h<r.length&&(d.src=r[h])}d.onload=m=>{this.setLoadSuccessStatus(d.src),g()},d.onerror=g,d.src=r[0]},this.preloadSingleImage=()=>{const{preLoad:e,preLoadGap:t,infinite:s}=this.getProps(),{imgSrc:i,currentIndex:o,direction:r,imgLoadStatus:d}=this.getStates();if(!e||typeof t!="number"||t<1)return;let h=o+(r==="prev"?-1:1)*t;if(h<0||h>=i.length)if(s)h=(h+i.length)%i.length;else return;if(!d[h]){const g=new Image;g.onload=m=>{this.setLoadSuccessStatus(i[h])},g.src=i[h]}},this.setLoadSuccessStatus=e=>{const{imgLoadStatus:t}=this.getStates(),s=Object.assign({},t);s[e]=!0,this.setState({imgLoadStatus:s})},this.onImageLoad=e=>{const{preloadAfterVisibleChange:t}=this.getStates();this.setLoadSuccessStatus(e),t?(this.preloadGapImage(),this.setState({preloadAfterVisibleChange:!1})):this.preloadSingleImage()}}beforeShow(){this._adapter.registerKeyDownListener(),this._adapter.disabledBodyScroll(),this.updateTimer()}afterHide(){this._adapter.unregisterKeyDownListener(),this._adapter.enabledBodyScroll(),this.clearTimer()}}const Ie=ee.PREFIX;class ie extends X{get adapter(){var a=this;return Object.assign(Object.assign({},super.adapter),{getIsInGroup:()=>this.isInGroup(),disabledBodyScroll:()=>{const{getPopupContainer:n}=this.props;this.bodyOverflow=document.body.style.overflow||"",!n&&this.bodyOverflow!=="hidden"&&(document.body.style.overflow="hidden",document.body.style.width=`calc(${this.originBodyWidth||"100%"} - ${this.scrollBarWidth}px)`)},enabledBodyScroll:()=>{const{getPopupContainer:n}=this.props;!n&&this.bodyOverflow!=="hidden"&&(document.body.style.overflow=this.bodyOverflow,document.body.style.width=this.originBodyWidth)},notifyChange:(n,e)=>{const{onChange:t,onPrev:s,onNext:i}=this.props;H(t)&&t(n),e==="prev"?s&&s(n):i&&i(n)},notifyZoom:(n,e)=>{const{onZoomIn:t,onZoomOut:s}=this.props;e?H(t)&&t(n):H(s)&&s(n)},notifyClose:()=>{const{onClose:n}=this.props;H(n)&&n()},notifyVisibleChange:n=>{const{onVisibleChange:e}=this.props;H(e)&&e(n)},notifyRatioChange:n=>{const{onRatioChange:e}=this.props;H(e)&&e(n)},notifyRotateChange:n=>{const{onRotateLeft:e}=this.props;H(e)&&e(n)},notifyDownload:(n,e)=>{const{onDownload:t}=this.props;H(t)&&t(n,e)},notifyDownloadError:n=>{const{onDownloadError:e}=this.props;H(e)&&e(n)},registerKeyDownListener:()=>{window&&window.addEventListener("keydown",this.handleKeyDown)},unregisterKeyDownListener:()=>{window&&window.removeEventListener("keydown",this.handleKeyDown)},getSetDownloadFunc:()=>{var n,e;return(e=(n=this.context)===null||n===void 0?void 0:n.setDownloadName)!==null&&e!==void 0?e:this.props.setDownloadName},isValidTarget:n=>{const e=this.headerRef&&this.headerRef.current,t=this.footerRef&&this.footerRef.current,s=this.leftIconRef&&this.leftIconRef.current,i=this.rightIconRef&&this.rightIconRef.current,o=n.target;return!(e&&e.contains(o)||t&&t.contains(o)||s&&s.contains(o)||i&&i.contains(o))},changeImageZoom:function(){var n;!((n=a.imageRef)===null||n===void 0)&&n.current&&a.imageRef.current.foundation.changeZoom(...arguments)}})}constructor(a){var n;super(a),n=this,this.viewVisibleChange=()=>{this.foundation.handleViewVisibleChange()},this.handleSwitchImage=e=>{this.foundation.handleSwitchImage(e)},this.handleDownload=()=>{this.foundation.handleDownload()},this.handlePreviewClose=e=>{this.foundation.handlePreviewClose(e)},this.handleAdjustRatio=e=>{this.foundation.handleAdjustRatio(e)},this.handleRotateImage=e=>{this.foundation.handleRotateImage(e)},this.handleZoomImage=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;n.foundation.handleZoomImage(e,t)},this.handleMouseUp=e=>{this.foundation.handleMouseUp(e.nativeEvent)},this.handleMouseMove=e=>{this.foundation.handleMouseMove(e)},this.handleKeyDown=e=>{this.foundation.handleKeyDown(e)},this.onImageError=()=>{this.foundation.preloadSingleImage()},this.onImageLoad=e=>{this.foundation.onImageLoad(e)},this.handleMouseDown=e=>{this.foundation.handleMouseDown(e)},this.handleWheel=e=>{this.foundation.handleWheel(e)},this.registryImageWrapRef=e=>{this.imageWrapRef&&this.imageWrapRef.removeEventListener("wheel",this.handleWheel),e&&e.addEventListener("wheel",this.handleWheel,{passive:!1}),this.imageWrapRef=e},this.state={imgSrc:[],imgLoadStatus:new Map,zoom:.1,currentIndex:0,ratio:"adaptation",rotation:0,viewerVisible:!0,visible:!1,preloadAfterVisibleChange:!0,direction:""},this.foundation=new jt(this.adapter),this.bodyOverflow="",this.originBodyWidth="100%",this.scrollBarWidth=0,this.imageWrapRef=null,this.imageRef=u.createRef(),this.headerRef=u.createRef(),this.footerRef=u.createRef(),this.leftIconRef=u.createRef(),this.rightIconRef=u.createRef()}static getDerivedStateFromProps(a,n){const e={};let t=[];return a.visible&&(t=Array.isArray(a.src)?a.src:[a.src]),de(t,n.imgSrc)||(e.imgSrc=t),a.visible!==n.visible&&(e.visible=a.visible,a.visible&&(e.preloadAfterVisibleChange=!0,e.viewerVisible=!0,e.rotation=0,e.ratio="adaptation")),"currentIndex"in a&&a.currentIndex!==n.currentIndex&&(e.currentIndex=a.currentIndex,e.ratio="adaptation"),e}componentDidMount(){this.scrollBarWidth=He(),this.originBodyWidth=document.body.style.width,this.props.visible&&this.foundation.beforeShow()}componentDidUpdate(a,n){a.src!==this.props.src&&this.foundation.updateTimer(),!a.visible&&this.props.visible&&this.foundation.beforeShow(),a.visible&&!this.props.visible&&this.foundation.afterHide()}componentWillUnmount(){this.foundation.clearTimer()}isInGroup(){return!!(this.context&&this.context.isGroup)}render(){const{getPopupContainer:a,closable:n,zIndex:e,visible:t,className:s,style:i,infinite:o,zoomStep:r,crossOrigin:d,prevTip:h,nextTip:g,zoomInTip:m,zoomOutTip:f,rotateTip:y,downloadTip:v,adaptiveTip:C,originTip:I,showTooltip:S,disableDownload:w,renderPreviewMenu:_,renderHeader:j}=this.props,{currentIndex:L,imgSrc:A,zoom:N,ratio:B,rotation:$,viewerVisible:G}=this.state;let q={zIndex:e};a&&(q={zIndex:e,position:"static"});const k=`${Ie}-preview`,te=E(k,{[`${Ie}-hide`]:!t,[`${k}-popup`]:a},s),F=G?"":`${k}-hide`,D=A.length,W=D!==1&&(o||L!==0),x=D!==1&&(o||L!==D-1);return t&&u.createElement(Ae,{getPopupContainer:a,style:q},u.createElement("div",{className:te,style:i,onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,ref:this.registryImageWrapRef,onMouseMove:this.handleMouseMove},u.createElement(Ot,{ref:this.headerRef,className:E(F),onClose:this.handlePreviewClose,renderHeader:j,closable:n}),u.createElement(ye,{ref:this.imageRef,src:A[L],onZoom:this.handleZoomImage,disableDownload:w,setRatio:this.handleAdjustRatio,zoom:N,ratio:B,rotation:$,crossOrigin:d,onError:this.onImageError,onLoad:this.onImageLoad}),W&&u.createElement("div",{ref:this.leftIconRef,className:E(`${k}-icon`,`${k}-prev`,F),onClick:()=>this.handleSwitchImage("prev")},u.createElement(We,{size:"large"})),x&&u.createElement("div",{ref:this.rightIconRef,className:E(`${k}-icon`,`${k}-next`,F),onClick:()=>this.handleSwitchImage("next")},u.createElement(Ue,{size:"large"})),u.createElement(be,{forwardRef:this.footerRef,className:F,totalNum:D,curPage:L+1,disabledPrev:!W,disabledNext:!x,zoom:N*100,step:r*100,showTooltip:S,ratio:B,prevTip:h,nextTip:g,zIndex:e,zoomInTip:m,zoomOutTip:f,rotateTip:y,downloadTip:v,disableDownload:w,adaptiveTip:C,originTip:I,onPrev:()=>this.handleSwitchImage("prev"),onNext:()=>this.handleSwitchImage("next"),onZoomIn:this.handleZoomImage,onZoomOut:this.handleZoomImage,onDownload:this.handleDownload,onRotate:this.handleRotateImage,onAdjustRatio:this.handleAdjustRatio,renderPreviewMenu:_})))}}ie.contextType=ve;ie.propTypes={style:l.object,className:l.string,visible:l.bool,src:l.oneOfType([l.string,l.array]),currentIndex:l.number,defaultCurrentIndex:l.number,defaultVisible:l.bool,maskClosable:l.bool,closable:l.bool,zoomStep:l.number,infinite:l.bool,showTooltip:l.bool,closeOnEsc:l.bool,prevTip:l.string,nextTip:l.string,zoomInTip:l.string,zoomOutTip:l.string,downloadTip:l.string,adaptiveTip:l.string,originTip:l.string,lazyLoad:l.bool,preLoad:l.bool,preLoadGap:l.number,disableDownload:l.bool,viewerVisibleDelay:l.number,zIndex:l.number,maxZoom:l.number,minZoom:l.number,renderHeader:l.func,renderPreviewMenu:l.func,getPopupContainer:l.func,onVisibleChange:l.func,onChange:l.func,onClose:l.func,onZoomIn:l.func,onZoomOut:l.func,onPrev:l.func,onNext:l.func,onDownload:l.func,onRatioChange:l.func,onRotateLeft:l.func};ie.defaultProps={showTooltip:!1,zoomStep:.1,infinite:!1,closeOnEsc:!0,lazyLoad:!1,preLoad:!0,preLoadGap:2,zIndex:Rt.DEFAULT_Z_INDEX,maskClosable:!0,viewerVisibleDelay:1e4,maxZoom:5,minZoom:.1};class Bt extends K{constructor(a){super(Object.assign({},a)),this.handleClick=n=>{const{imageID:e,preview:t}=this.getProps();if(t)if(this._adapter.getIsInGroup()){const{setCurrentIndex:s,handleVisibleChange:i}=this._adapter.getContexts();s(e),i(!0)}else this.handlePreviewVisibleChange(!0)},this.handleLoaded=n=>{const{onLoad:e}=this.getProps();e&&e(n),this.setState({loadStatus:"success"})},this.handleError=n=>{const{onError:e}=this.getProps();e&&e(n),this.setState({loadStatus:"error"})},this.handlePreviewVisibleChange=n=>{const{preview:e}=this.getProps();if(ne(e)){const{onVisibleChange:t}=e;t&&t(n),"visible"in e||this.setState({previewVisible:n})}else this.setState({previewVisible:n})}}}var Ft=function(c,a){var n={};for(var e in c)Object.prototype.hasOwnProperty.call(c,e)&&a.indexOf(e)<0&&(n[e]=c[e]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function")for(var t=0,e=Object.getOwnPropertySymbols(c);t<e.length;t++)a.indexOf(e[t])<0&&Object.prototype.propertyIsEnumerable.call(c,e[t])&&(n[e[t]]=c[e[t]]);return n};const O=ee.PREFIX;let ae=class extends X{get adapter(){return Object.assign(Object.assign({},super.adapter),{getIsInGroup:()=>this.isInGroup()})}constructor(a){super(a),this.handleClick=n=>{this.foundation.handleClick(n)},this.handleLoaded=n=>{this.foundation.handleLoaded(n)},this.handleError=n=>{this.foundation.handleError(n)},this.handlePreviewVisibleChange=n=>{this.foundation.handlePreviewVisibleChange(n)},this.renderDefaultLoading=()=>{const{width:n,height:e}=this.props;return u.createElement(z.Image,{style:{width:n,height:e}})},this.renderDefaultError=()=>{const n=`${O}-status`;return u.createElement("div",{className:n},u.createElement(lt,{size:"extra-large"}))},this.renderLoad=()=>{const n=`${O}-status`,{placeholder:e}=this.props;return e?u.createElement("div",{className:n},e):this.renderDefaultLoading()},this.renderError=()=>{const{fallback:n}=this.props,e=`${O}-status`,t=typeof n=="string"?u.createElement("img",{style:{width:"100%",height:"100%"},src:n,alt:"fallback"}):n;return n?u.createElement("div",{className:e},t):this.renderDefaultError()},this.renderExtra=()=>{const{loadStatus:n}=this.state;return u.createElement("div",{className:`${O}-overlay`},n==="error"&&this.renderError(),n==="loading"&&this.renderLoad())},this.getLocalTextByKey=n=>u.createElement(Te,{componentName:"Image"},e=>e[n]),this.renderMask=()=>u.createElement("div",{className:`${O}-mask`},u.createElement("div",{className:`${O}-mask-info`},u.createElement(Je,{size:"extra-large"}),u.createElement("span",{className:`${O}-mask-info-text`},this.getLocalTextByKey("preview")))),this.state={src:"",loadStatus:"loading",previewVisible:!1},this.foundation=new Bt(this.adapter),this.imgRef=u.createRef()}static getDerivedStateFromProps(a,n){const e={};if(a.src!==n.src&&(e.src=a.src,e.loadStatus="loading"),ne(a.preview)){const{visible:t}=a.preview;St(t)&&(e.previewVisible=t)}return e}isInGroup(){return!!(this.context&&this.context.isGroup)}isLazyLoad(){return this.context?this.context.lazyLoad:!1}render(){var a;const{src:n,loadStatus:e,previewVisible:t}=this.state,s=this.props,{src:i,width:o,height:r,alt:d,style:h,className:g,crossOrigin:m,preview:f,fallback:y,placeholder:v,imageID:C,setDownloadName:I,imgCls:S,imgStyle:w}=s,_=Ft(s,["src","width","height","alt","style","className","crossOrigin","preview","fallback","placeholder","imageID","setDownloadName","imgCls","imgStyle"]),j=Object.assign({width:o,height:r},h),L=E(O,g),A=e==="success"&&f&&!this.isInGroup(),N=f&&e==="success",B=ne(f)&&(a=f.src)!==null&&a!==void 0?a:n,$=ne(f)&&A?Object.assign(Object.assign({},ze(f,["className","style","previewCls","previewStyle"])),{className:f==null?void 0:f.previewCls,style:f==null?void 0:f.previewStyle}):{};return u.createElement("div",{style:j,className:L,onClick:this.handleClick},u.createElement("img",Object.assign({ref:this.imgRef},_,{src:this.isInGroup()&&this.isLazyLoad()?void 0:n,"data-src":n,alt:d,style:w,className:E(`${O}-img`,{[`${O}-img-preview`]:N,[`${O}-img-error`]:e==="error",[S]:!!S}),width:o,height:r,crossOrigin:m,onError:this.handleError,onLoad:this.handleLoaded})),e!=="success"&&this.renderExtra(),A&&u.createElement(ie,Object.assign({},$,{src:B,visible:t,onVisibleChange:this.handlePreviewVisibleChange,crossOrigin:Re(m)?$==null?void 0:$.crossOrigin:m,setDownloadName:I})))}};ae.isSemiImage=!0;ae.contextType=ve;ae.propTypes={style:l.object,className:l.string,src:l.string,width:l.oneOfType([l.string,l.number]),height:l.oneOfType([l.string,l.number]),alt:l.string,placeholder:l.node,fallback:l.oneOfType([l.string,l.node]),preview:l.oneOfType([l.bool,l.object]),onLoad:l.func,onError:l.func,onClick:l.func,crossOrigin:l.string,imageID:l.number};ae.defaultProps={preview:!0};export{Ee as D,ae as I};
