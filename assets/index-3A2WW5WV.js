import{j as i,r as y,_ as m}from"./index-BCspk9AZ.js";import{C as S,b as h,c as _,D as w,d as g,e as D,M as E}from"./core.esm-DHWXjPgB.js";import{u as b,T as M,S as I,r as x,a as C}from"./index-UaKcqU7D.js";import{B as N}from"./index-D3jpb7PM.js";import"./IconClose-CRHBs1TW.js";import"./IconTickCircle-D1l1yo1O.js";const T="_wrapper_572ws_1",R="_container_572ws_5",j={wrapper:T,container:R};function v(n){const{listeners:d,setNodeRef:a,transform:l,transition:o}=b({id:n.id,data:{pId:null}}),c={transition:o,transform:S.Transform.toString(l)};return i.jsxs("div",{className:j.container,style:c,ref:a,children:[i.jsx("h1",{...d,children:n.id}),n.children]})}const B="_sortableItem_y1u8g_1",L={sortableItem:B};function $(n){const{listeners:d,setNodeRef:a,transform:l,transition:o}=b({id:n.id,data:{pId:n.pId}}),c={transition:o,transform:S.Transform.toString(l)};return i.jsx("div",{...d,onClick:()=>M.info(`你点击了${n.id}`),className:L.sortableItem,style:c,ref:a,children:n.id})}function G(){const[n,d]=y.useState([{id:"parent-1",list:[{id:"son1-1",pId:"parent-1"},{id:"son1-2",pId:"parent-1"},{id:"son1-3",pId:"parent-1"}]},{id:"parent-2",list:[{id:"son2-1",pId:"parent-2"},{id:"son2-2",pId:"parent-2"},{id:"son2-3",pId:"parent-2"}]},{id:"parent-3",list:[{id:"son3-1",pId:"parent-3"},{id:"son3-2",pId:"parent-3"},{id:"son3-3",pId:"parent-3"}]}]),a=h(_(E,{activationConstraint:{distance:5}}));function l(t){const{active:s}=t;if(s.id.includes("parent"))return g({...t,droppableContainers:t.droppableContainers.filter(e=>e.id.includes("parent"))});if(s.id.includes("son")){const e=D({...t,droppableContainers:t.droppableContainers.filter(r=>r.id.includes("son"))});return console.log(e[0]),e}}function o(t,s){return t.findIndex(r=>r.id===s)}function c({active:t,over:s}){if(!(m.isEmpty(t)||m.isEmpty(s))){if(t.id.includes("parent")&&s.id.includes("parent")){const e=o(n,t.id),r=o(n,s.id);e!==r&&d(p=>C(p,e,r));return}if(t.data.current.pId===s.data.current.pId){const e=n.findIndex(u=>u.id===t.data.current.pId),r=o(n[e].list,t.id),p=o(n[e].list,s.id);r!==p&&d(u=>{const f=[...u];return f[e].list=C(f[e].list,r,p),f})}}}return i.jsxs(w,{sensors:a,collisionDetection:l,onDragEnd:c,children:[i.jsx(N,{type:"info",fullMode:!1,description:"依靠自定义碰撞检测函数实现（未完成）"}),i.jsx("br",{}),i.jsx("div",{className:j.wrapper,children:i.jsx(I,{items:n.map(t=>t.id),strategy:x,children:n.map(t=>i.jsx(v,{id:t.id,children:i.jsx(I,{items:t.list.map(s=>s.id),strategy:x,children:t.list.map(s=>i.jsx($,{id:s.id,pId:s.pId},s.id))})},t.id))})})]})}export{G as default};
